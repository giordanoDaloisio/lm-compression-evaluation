No CUDA runtime is found, using CUDA_HOME='/usr/local/cuda'
08/08/2024 14:32:57 - INFO - __main__ -   Namespace(model_type='roberta', model_name_or_path='microsoft/codebert-base', output_dir='model/java', load_model_path='model/java/checkpoint-best-bleu/pytorch_model.bin', train_filename=None, dev_filename=None, test_filename='../dataset/java/test.jsonl', config_name='', tokenizer_name='', max_source_length=256, max_target_length=128, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=True, quantize=False, quantize4=False, quantizef8=False, prune=False, prune4=False, prune6=False, do_retrain=False, train_batch_size=8, eval_batch_size=64, gradient_accumulation_steps=1, learning_rate=5e-05, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=3, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=0, local_rank=-1, seed=42, job_id='92577', file_len=300)
08/08/2024 14:32:57 - WARNING - __main__ -   Process rank: -1, device: cpu, n_gpu: 2, distributed training: False
08/08/2024 14:33:03 - INFO - __main__ -   reload model from model/java/checkpoint-best-bleu/pytorch_model.bin
08/08/2024 14:33:10 - INFO - __main__ -   Size (MB): 706.910458
08/08/2024 14:33:10 - INFO - __main__ -   Test file: ../dataset/java/test.jsonl
  0%|          | 0/172 [00:00<?, ?it/s]  1%|          | 1/172 [03:50<10:56:19, 230.29s/it]  1%|          | 2/172 [06:45<9:20:41, 197.89s/it]   2%|▏         | 3/172 [09:43<8:51:27, 188.68s/it]  2%|▏         | 4/172 [15:05<11:15:56, 241.41s/it]  3%|▎         | 5/172 [32:08<24:15:57, 523.10s/it]  3%|▎         | 6/172 [1:10:26<51:57:15, 1126.72s/it]  4%|▍         | 7/172 [1:43:04<64:05:51, 1398.49s/it]  5%|▍         | 8/172 [2:10:26<67:14:46, 1476.14s/it]  5%|▌         | 9/172 [2:39:46<70:51:04, 1564.81s/it]  6%|▌         | 10/172 [3:08:15<72:24:48, 1609.19s/it]  6%|▋         | 11/172 [3:37:41<74:06:46, 1657.18s/it]  7%|▋         | 12/172 [4:09:17<76:53:13, 1729.96s/it]  8%|▊         | 13/172 [4:42:31<79:56:27, 1809.99s/it]  8%|▊         | 14/172 [5:15:55<82:00:31, 1868.55s/it]  9%|▊         | 15/172 [5:43:37<78:45:58, 1806.10s/it]  9%|▉         | 16/172 [6:09:36<75:02:34, 1731.76s/it] 10%|▉         | 17/172 [6:35:00<71:52:35, 1669.39s/it] 10%|█         | 18/172 [6:56:49<66:47:09, 1561.23s/it] 11%|█         | 19/172 [7:20:22<64:27:27, 1516.65s/it] 12%|█▏        | 20/172 [7:45:31<63:55:49, 1514.14s/it] 12%|█▏        | 21/172 [8:09:27<62:32:00, 1490.86s/it] 13%|█▎        | 22/172 [8:38:13<65:03:19, 1561.33s/it] 13%|█▎        | 23/172 [9:08:42<67:56:42, 1641.63s/it] 14%|█▍        | 24/172 [9:37:06<68:15:45, 1660.44s/it] 15%|█▍        | 25/172 [10:04:05<67:17:20, 1647.89s/it] 15%|█▌        | 26/172 [10:32:48<67:44:38, 1670.40s/it] 16%|█▌        | 27/172 [11:01:23<67:49:45, 1684.04s/it] 16%|█▋        | 28/172 [11:31:58<69:09:49, 1729.10s/it] 17%|█▋        | 29/172 [12:01:14<69:00:36, 1737.32s/it] 17%|█▋        | 30/172 [12:31:22<69:21:54, 1758.56s/it] 18%|█▊        | 31/172 [12:57:55<66:55:57, 1708.92s/it] 19%|█▊        | 32/172 [13:24:02<64:47:40, 1666.15s/it] 19%|█▉        | 33/172 [13:45:18<59:49:06, 1549.25s/it] 20%|█▉        | 34/172 [14:00:28<52:02:19, 1357.53s/it] 20%|██        | 35/172 [14:16:25<47:05:23, 1237.40s/it] 21%|██        | 36/172 [14:30:46<42:28:12, 1124.21s/it] 22%|██▏       | 37/172 [14:47:03<40:30:32, 1080.24s/it] 22%|██▏       | 38/172 [15:02:02<38:10:47, 1025.73s/it] 23%|██▎       | 39/172 [15:21:57<39:46:38, 1076.68s/it] 23%|██▎       | 40/172 [15:41:47<40:43:23, 1110.63s/it] 24%|██▍       | 41/172 [16:04:11<42:57:30, 1180.54s/it] 24%|██▍       | 42/172 [16:25:58<43:59:54, 1218.42s/it] 25%|██▌       | 43/172 [16:45:50<43:22:29, 1210.46s/it] 26%|██▌       | 44/172 [17:04:03<41:47:09, 1175.23s/it] 26%|██▌       | 45/172 [17:15:07<36:03:31, 1022.14s/it] 27%|██▋       | 46/172 [17:22:48<29:52:53, 853.75s/it]  27%|██▋       | 47/172 [17:30:42<25:41:13, 739.79s/it] 28%|██▊       | 48/172 [17:44:42<26:31:11, 769.93s/it] 28%|██▊       | 49/172 [17:59:37<27:34:49, 807.23s/it] 29%|██▉       | 50/172 [18:09:06<24:56:11, 735.83s/it] 30%|██▉       | 51/172 [18:12:38<19:26:47, 578.57s/it] 30%|███       | 52/172 [18:17:33<16:27:22, 493.69s/it] 31%|███       | 53/172 [18:21:59<14:03:42, 425.40s/it] 31%|███▏      | 54/172 [18:25:47<12:00:12, 366.21s/it] 32%|███▏      | 55/172 [18:29:44<10:38:30, 327.44s/it] 33%|███▎      | 56/172 [18:33:16<9:25:54, 292.72s/it]  33%|███▎      | 57/172 [18:36:39<8:29:32, 265.84s/it] 34%|███▎      | 58/172 [18:39:01<7:14:40, 228.77s/it] 34%|███▍      | 59/172 [18:42:06<6:45:47, 215.46s/it] 35%|███▍      | 60/172 [18:45:02<6:20:04, 203.61s/it] 35%|███▌      | 61/172 [18:47:39<5:50:46, 189.61s/it] 36%|███▌      | 62/172 [18:50:08<5:25:10, 177.37s/it] 37%|███▋      | 63/172 [18:54:37<6:12:10, 204.87s/it] 37%|███▋      | 64/172 [19:01:07<7:49:09, 260.64s/it] 38%|███▊      | 65/172 [19:15:43<13:13:53, 445.17s/it] 38%|███▊      | 66/172 [19:36:12<20:02:01, 680.39s/it] 39%|███▉      | 67/172 [19:55:50<24:11:47, 829.59s/it] 40%|███▉      | 68/172 [20:05:48<21:57:39, 760.19s/it] 40%|████      | 69/172 [20:10:11<17:28:51, 610.99s/it] 41%|████      | 70/172 [20:12:16<13:10:55, 465.25s/it] 41%|████▏     | 71/172 [20:15:02<10:31:37, 375.22s/it] 42%|████▏     | 72/172 [20:16:58<8:16:00, 297.60s/it]  42%|████▏     | 73/172 [20:20:10<7:18:59, 266.06s/it] 43%|████▎     | 74/172 [20:23:07<6:30:48, 239.27s/it] 44%|████▎     | 75/172 [20:25:05<5:28:03, 202.92s/it] 44%|████▍     | 76/172 [20:26:59<4:41:53, 176.18s/it] 45%|████▍     | 77/172 [20:29:04<4:14:36, 160.80s/it] 45%|████▌     | 78/172 [20:31:15<3:57:57, 151.89s/it] 46%|████▌     | 79/172 [20:33:16<3:41:03, 142.62s/it] 47%|████▋     | 80/172 [20:35:54<3:45:34, 147.11s/it] 47%|████▋     | 81/172 [20:37:23<3:16:57, 129.87s/it] 48%|████▊     | 82/172 [20:39:09<3:04:02, 122.69s/it] 48%|████▊     | 83/172 [20:40:57<2:55:22, 118.23s/it] 49%|████▉     | 84/172 [20:42:50<2:51:07, 116.67s/it] 49%|████▉     | 85/172 [20:45:03<2:56:05, 121.44s/it] 50%|█████     | 86/172 [20:47:00<2:52:14, 120.17s/it] 51%|█████     | 87/172 [20:48:36<2:39:51, 112.85s/it] 51%|█████     | 88/172 [20:50:33<2:39:48, 114.15s/it] 52%|█████▏    | 89/172 [20:52:34<2:40:45, 116.22s/it] 52%|█████▏    | 90/172 [20:55:12<2:55:53, 128.71s/it] 53%|█████▎    | 91/172 [20:57:49<3:05:17, 137.25s/it] 53%|█████▎    | 92/172 [21:00:16<3:06:58, 140.23s/it] 54%|█████▍    | 93/172 [21:01:36<2:40:46, 122.11s/it] 55%|█████▍    | 94/172 [21:03:21<2:32:14, 117.12s/it] 55%|█████▌    | 95/172 [21:05:24<2:32:21, 118.72s/it] 56%|█████▌    | 96/172 [21:07:18<2:28:40, 117.37s/it] 56%|█████▋    | 97/172 [21:09:32<2:32:55, 122.34s/it] 57%|█████▋    | 98/172 [21:11:55<2:38:39, 128.64s/it] 58%|█████▊    | 99/172 [21:13:50<2:31:12, 124.28s/it] 58%|█████▊    | 100/172 [21:15:35<2:22:13, 118.52s/it] 59%|█████▊    | 101/172 [21:18:13<2:34:19, 130.41s/it] 59%|█████▉    | 102/172 [21:20:08<2:26:51, 125.87s/it] 60%|█████▉    | 103/172 [21:21:55<2:18:15, 120.23s/it] 60%|██████    | 104/172 [21:23:57<2:16:48, 120.72s/it] 61%|██████    | 105/172 [21:26:00<2:15:38, 121.47s/it] 62%|██████▏   | 106/172 [21:27:37<2:05:26, 114.04s/it] 62%|██████▏   | 107/172 [21:29:36<2:05:16, 115.65s/it] 63%|██████▎   | 108/172 [21:32:08<2:14:50, 126.42s/it] 63%|██████▎   | 109/172 [21:34:26<2:16:22, 129.88s/it] 64%|██████▍   | 110/172 [21:37:20<2:28:00, 143.24s/it] 65%|██████▍   | 111/172 [21:39:08<2:14:52, 132.67s/it] 65%|██████▌   | 112/172 [21:40:49<2:03:10, 123.17s/it] 66%|██████▌   | 113/172 [21:42:46<1:59:09, 121.17s/it] 66%|██████▋   | 114/172 [21:44:34<1:53:30, 117.43s/it] 67%|██████▋   | 115/172 [21:46:55<1:58:09, 124.38s/it] 67%|██████▋   | 116/172 [21:48:45<1:52:05, 120.10s/it] 68%|██████▊   | 117/172 [21:50:38<1:48:05, 117.92s/it] 69%|██████▊   | 118/172 [21:52:40<1:47:15, 119.17s/it] 69%|██████▉   | 119/172 [21:55:08<1:52:55, 127.84s/it] 70%|██████▉   | 120/172 [21:57:11<1:49:27, 126.29s/it] 70%|███████   | 121/172 [21:59:06<1:44:36, 123.07s/it] 71%|███████   | 122/172 [22:01:06<1:41:38, 121.96s/it] 72%|███████▏  | 123/172 [22:02:58<1:37:08, 118.95s/it] 72%|███████▏  | 124/172 [22:04:48<1:33:09, 116.44s/it] 73%|███████▎  | 125/172 [22:07:07<1:36:21, 123.01s/it] 73%|███████▎  | 126/172 [22:09:10<1:34:17, 122.99s/it] 74%|███████▍  | 127/172 [22:11:08<1:31:08, 121.52s/it] 74%|███████▍  | 128/172 [22:12:28<1:19:58, 109.06s/it] 75%|███████▌  | 129/172 [22:13:53<1:13:09, 102.08s/it] 76%|███████▌  | 130/172 [22:15:32<1:10:42, 101.01s/it] 76%|███████▌  | 131/172 [22:17:04<1:07:15, 98.43s/it]  77%|███████▋  | 132/172 [22:18:41<1:05:22, 98.06s/it] 77%|███████▋  | 133/172 [22:20:19<1:03:39, 97.94s/it] 78%|███████▊  | 134/172 [22:22:08<1:04:07, 101.26s/it] 78%|███████▊  | 135/172 [22:23:41<1:00:51, 98.69s/it]  79%|███████▉  | 136/172 [22:25:21<59:26, 99.07s/it]   80%|███████▉  | 137/172 [22:27:24<1:02:04, 106.41s/it] 80%|████████  | 138/172 [22:29:11<1:00:19, 106.46s/it] 81%|████████  | 139/172 [22:30:46<56:38, 102.99s/it]   81%|████████▏ | 140/172 [22:32:33<55:39, 104.35s/it] 82%|████████▏ | 141/172 [22:34:48<58:36, 113.45s/it] 83%|████████▎ | 142/172 [22:36:54<58:40, 117.35s/it] 83%|████████▎ | 143/172 [22:38:49<56:14, 116.37s/it] 84%|████████▎ | 144/172 [22:41:06<57:12, 122.58s/it] 84%|████████▍ | 145/172 [22:42:51<52:47, 117.32s/it] 85%|████████▍ | 146/172 [22:45:41<57:47, 133.37s/it] 85%|████████▌ | 147/172 [22:47:33<52:53, 126.95s/it] 86%|████████▌ | 148/172 [22:50:07<53:56, 134.86s/it] 87%|████████▋ | 149/172 [22:52:58<55:52, 145.76s/it] 87%|████████▋ | 150/172 [22:54:51<49:52, 136.00s/it] 88%|████████▊ | 151/172 [22:56:54<46:10, 131.91s/it] 88%|████████▊ | 152/172 [22:59:13<44:45, 134.27s/it] 89%|████████▉ | 153/172 [23:01:29<42:39, 134.70s/it] 90%|████████▉ | 154/172 [23:03:18<38:06, 127.03s/it] 90%|█████████ | 155/172 [23:05:35<36:49, 130.00s/it] 91%|█████████ | 156/172 [23:08:11<36:43, 137.71s/it] 91%|█████████▏| 157/172 [23:10:43<35:32, 142.16s/it] 92%|█████████▏| 158/172 [23:12:07<29:06, 124.72s/it] 92%|█████████▏| 159/172 [23:14:32<28:17, 130.56s/it] 93%|█████████▎| 160/172 [23:17:54<30:25, 152.16s/it] 94%|█████████▎| 161/172 [23:22:12<33:41, 183.74s/it] 94%|█████████▍| 162/172 [23:25:07<30:13, 181.32s/it] 95%|█████████▍| 163/172 [23:28:07<27:07, 180.81s/it] 95%|█████████▌| 164/172 [23:32:49<28:09, 211.25s/it] 96%|█████████▌| 165/172 [23:36:52<25:45, 220.73s/it] 97%|█████████▋| 166/172 [23:39:04<19:24, 194.17s/it] 97%|█████████▋| 167/172 [23:41:58<15:40, 188.01s/it] 98%|█████████▊| 168/172 [23:44:45<12:06, 181.68s/it] 98%|█████████▊| 169/172 [23:47:41<09:00, 180.01s/it] 99%|█████████▉| 170/172 [23:50:46<06:03, 181.59s/it] 99%|█████████▉| 171/172 [23:54:07<03:07, 187.53s/it]100%|██████████| 172/172 [23:54:29<00:00, 137.86s/it]100%|██████████| 172/172 [23:54:29<00:00, 500.41s/it]
Total: 10955
08/09/2024 14:28:08 - INFO - __main__ -     bleu-4 = 18.79 
08/09/2024 14:28:08 - INFO - __main__ -     ********************
08/09/2024 14:28:08 - INFO - __main__ -   Average inference time: 500.38032420014224
