No CUDA runtime is found, using CUDA_HOME='/usr/local/cuda'
08/06/2024 13:24:31 - INFO - __main__ -   Namespace(model_type='roberta', model_name_or_path='microsoft/codebert-base', output_dir='model/java', load_model_path='model/java/checkpoint-best-bleu/pytorch_model.bin', train_filename=None, dev_filename=None, test_filename='../dataset/java/test.jsonl', config_name='', tokenizer_name='', max_source_length=256, max_target_length=128, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=True, quantize=False, quantize4=False, quantizef8=False, prune=True, prune4=False, prune6=False, do_retrain=False, train_batch_size=8, eval_batch_size=64, gradient_accumulation_steps=1, learning_rate=5e-05, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=3, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=0, local_rank=-1, seed=42, job_id='73531', file_len=300)
08/06/2024 13:24:31 - WARNING - __main__ -   Process rank: -1, device: cpu, n_gpu: 2, distributed training: False
08/06/2024 13:24:37 - INFO - __main__ -   reload model from model/java/checkpoint-best-bleu/pytorch_model.bin
08/06/2024 13:24:42 - INFO - __main__ -   Apply model pruning
08/06/2024 13:24:48 - INFO - __main__ -   Size (MB): 706.910458
08/06/2024 13:24:48 - INFO - __main__ -   Test file: ../dataset/java/test.jsonl
  0%|          | 0/172 [00:00<?, ?it/s]  1%|          | 1/172 [01:58<5:38:35, 118.81s/it]  1%|          | 2/172 [03:45<5:16:24, 111.68s/it]  2%|▏         | 3/172 [05:15<4:46:44, 101.80s/it]  2%|▏         | 4/172 [07:08<4:57:09, 106.13s/it]  3%|▎         | 5/172 [09:08<5:09:52, 111.33s/it]  3%|▎         | 6/172 [10:57<5:05:42, 110.50s/it]  4%|▍         | 7/172 [12:52<5:07:20, 111.76s/it]  5%|▍         | 8/172 [14:53<5:13:33, 114.72s/it]  5%|▌         | 9/172 [16:43<5:08:07, 113.42s/it]  6%|▌         | 10/172 [18:24<4:55:56, 109.61s/it]  6%|▋         | 11/172 [19:47<4:31:40, 101.24s/it]  7%|▋         | 12/172 [21:41<4:40:40, 105.25s/it]  8%|▊         | 13/172 [23:46<4:54:56, 111.30s/it]  8%|▊         | 14/172 [25:37<4:53:00, 111.27s/it]  9%|▊         | 15/172 [27:09<4:35:44, 105.38s/it]  9%|▉         | 16/172 [28:35<4:18:44, 99.52s/it]  10%|▉         | 17/172 [30:29<4:28:32, 103.95s/it] 10%|█         | 18/172 [32:20<4:32:04, 106.00s/it] 11%|█         | 19/172 [33:41<4:11:08, 98.49s/it]  12%|█▏        | 20/172 [34:57<3:52:29, 91.78s/it] 12%|█▏        | 21/172 [36:36<3:55:58, 93.77s/it] 13%|█▎        | 22/172 [38:06<3:51:45, 92.71s/it] 13%|█▎        | 23/172 [39:29<3:43:24, 89.96s/it] 14%|█▍        | 24/172 [40:46<3:31:45, 85.85s/it] 15%|█▍        | 25/172 [42:03<3:23:51, 83.21s/it] 15%|█▌        | 26/172 [43:16<3:15:34, 80.38s/it] 16%|█▌        | 27/172 [44:43<3:18:27, 82.12s/it] 16%|█▋        | 28/172 [46:04<3:16:46, 81.99s/it] 17%|█▋        | 29/172 [47:17<3:09:03, 79.32s/it] 17%|█▋        | 30/172 [48:55<3:20:20, 84.65s/it] 18%|█▊        | 31/172 [50:30<3:26:24, 87.84s/it] 19%|█▊        | 32/172 [52:08<3:32:25, 91.04s/it] 19%|█▉        | 33/172 [53:39<3:30:22, 90.81s/it] 20%|█▉        | 34/172 [55:13<3:31:14, 91.85s/it] 20%|██        | 35/172 [56:47<3:31:06, 92.45s/it] 21%|██        | 36/172 [58:13<3:25:31, 90.68s/it] 22%|██▏       | 37/172 [59:49<3:27:37, 92.28s/it] 22%|██▏       | 38/172 [1:01:18<3:23:45, 91.24s/it] 23%|██▎       | 39/172 [1:02:40<3:15:49, 88.34s/it] 23%|██▎       | 40/172 [1:04:06<3:13:15, 87.85s/it] 24%|██▍       | 41/172 [1:05:43<3:17:46, 90.58s/it] 24%|██▍       | 42/172 [1:07:27<3:25:02, 94.63s/it] 25%|██▌       | 43/172 [1:09:13<3:30:35, 97.95s/it] 26%|██▌       | 44/172 [1:10:40<3:21:41, 94.54s/it] 26%|██▌       | 45/172 [1:12:08<3:16:03, 92.63s/it] 27%|██▋       | 46/172 [1:13:29<3:07:08, 89.12s/it] 27%|██▋       | 47/172 [1:14:42<2:55:46, 84.37s/it] 28%|██▊       | 48/172 [1:16:00<2:50:27, 82.48s/it] 28%|██▊       | 49/172 [1:17:11<2:41:38, 78.85s/it] 29%|██▉       | 50/172 [1:18:22<2:35:49, 76.64s/it] 30%|██▉       | 51/172 [1:19:31<2:30:04, 74.41s/it] 30%|███       | 52/172 [1:21:02<2:38:49, 79.41s/it] 31%|███       | 53/172 [1:22:31<2:43:11, 82.28s/it] 31%|███▏      | 54/172 [1:23:58<2:44:14, 83.51s/it] 32%|███▏      | 55/172 [1:25:16<2:39:35, 81.84s/it] 33%|███▎      | 56/172 [1:26:32<2:35:21, 80.35s/it] 33%|███▎      | 57/172 [1:27:54<2:34:39, 80.69s/it] 34%|███▎      | 58/172 [1:29:06<2:28:40, 78.25s/it] 34%|███▍      | 59/172 [1:30:14<2:21:07, 74.94s/it] 35%|███▍      | 60/172 [1:31:21<2:15:49, 72.76s/it] 35%|███▌      | 61/172 [1:32:24<2:08:49, 69.63s/it] 36%|███▌      | 62/172 [1:33:25<2:03:19, 67.27s/it] 37%|███▋      | 63/172 [1:34:34<2:03:07, 67.78s/it] 37%|███▋      | 64/172 [1:36:05<2:14:34, 74.76s/it] 38%|███▊      | 65/172 [1:37:51<2:29:34, 83.88s/it] 38%|███▊      | 66/172 [1:39:21<2:31:24, 85.70s/it] 39%|███▉      | 67/172 [1:40:38<2:25:25, 83.10s/it] 40%|███▉      | 68/172 [1:41:56<2:21:29, 81.63s/it] 40%|████      | 69/172 [1:43:07<2:14:53, 78.57s/it] 41%|████      | 70/172 [1:44:39<2:20:22, 82.57s/it] 41%|████▏     | 71/172 [1:46:11<2:23:45, 85.40s/it] 42%|████▏     | 72/172 [1:47:31<2:19:42, 83.82s/it] 42%|████▏     | 73/172 [1:49:19<2:29:56, 90.87s/it] 43%|████▎     | 74/172 [1:50:38<2:22:55, 87.50s/it] 44%|████▎     | 75/172 [1:52:00<2:18:30, 85.68s/it] 44%|████▍     | 76/172 [1:53:21<2:14:45, 84.23s/it] 45%|████▍     | 77/172 [1:54:43<2:12:42, 83.82s/it] 45%|████▌     | 78/172 [1:55:57<2:06:28, 80.73s/it] 46%|████▌     | 79/172 [1:57:07<2:00:20, 77.64s/it] 47%|████▋     | 80/172 [1:58:27<1:59:59, 78.25s/it] 47%|████▋     | 81/172 [1:59:41<1:56:37, 76.89s/it] 48%|████▊     | 82/172 [2:00:52<1:52:40, 75.11s/it] 48%|████▊     | 83/172 [2:02:08<1:51:53, 75.43s/it] 49%|████▉     | 84/172 [2:03:25<1:51:24, 75.96s/it] 49%|████▉     | 85/172 [2:04:43<1:51:08, 76.65s/it] 50%|█████     | 86/172 [2:06:18<1:57:47, 82.18s/it] 51%|█████     | 87/172 [2:07:51<2:01:00, 85.42s/it] 51%|█████     | 88/172 [2:09:06<1:55:11, 82.28s/it] 52%|█████▏    | 89/172 [2:10:27<1:52:59, 81.69s/it] 52%|█████▏    | 90/172 [2:11:37<1:47:10, 78.41s/it] 53%|█████▎    | 91/172 [2:12:57<1:46:11, 78.66s/it] 53%|█████▎    | 92/172 [2:14:03<1:39:59, 74.99s/it] 54%|█████▍    | 93/172 [2:15:14<1:37:00, 73.68s/it] 55%|█████▍    | 94/172 [2:16:20<1:33:02, 71.57s/it] 55%|█████▌    | 95/172 [2:17:24<1:28:47, 69.18s/it] 56%|█████▌    | 96/172 [2:18:26<1:24:57, 67.07s/it] 56%|█████▋    | 97/172 [2:19:35<1:24:23, 67.52s/it] 57%|█████▋    | 98/172 [2:20:55<1:28:05, 71.42s/it] 58%|█████▊    | 99/172 [2:22:11<1:28:27, 72.71s/it] 58%|█████▊    | 100/172 [2:23:14<1:23:53, 69.91s/it] 59%|█████▊    | 101/172 [2:24:18<1:20:36, 68.12s/it] 59%|█████▉    | 102/172 [2:25:28<1:19:57, 68.53s/it] 60%|█████▉    | 103/172 [2:26:38<1:19:19, 68.98s/it] 60%|██████    | 104/172 [2:27:50<1:19:08, 69.84s/it] 61%|██████    | 105/172 [2:28:57<1:17:17, 69.21s/it] 62%|██████▏   | 106/172 [2:30:12<1:17:53, 70.81s/it] 62%|██████▏   | 107/172 [2:31:24<1:17:11, 71.25s/it] 63%|██████▎   | 108/172 [2:32:54<1:21:54, 76.79s/it] 63%|██████▎   | 109/172 [2:34:18<1:23:02, 79.09s/it] 64%|██████▍   | 110/172 [2:35:38<1:21:50, 79.20s/it] 65%|██████▍   | 111/172 [2:36:49<1:18:01, 76.75s/it] 65%|██████▌   | 112/172 [2:38:42<1:27:38, 87.64s/it] 66%|██████▌   | 113/172 [2:40:04<1:24:33, 86.00s/it] 66%|██████▋   | 114/172 [2:41:14<1:18:21, 81.06s/it] 67%|██████▋   | 115/172 [2:42:35<1:17:02, 81.10s/it] 67%|██████▋   | 116/172 [2:43:41<1:11:31, 76.63s/it] 68%|██████▊   | 117/172 [2:45:06<1:12:26, 79.02s/it] 69%|██████▊   | 118/172 [2:47:00<1:20:41, 89.66s/it] 69%|██████▉   | 119/172 [2:48:33<1:20:10, 90.76s/it] 70%|██████▉   | 120/172 [2:49:57<1:16:48, 88.62s/it] 70%|███████   | 121/172 [2:51:08<1:10:48, 83.30s/it] 71%|███████   | 122/172 [2:52:32<1:09:41, 83.64s/it] 72%|███████▏  | 123/172 [2:53:45<1:05:40, 80.43s/it] 72%|███████▏  | 124/172 [2:54:57<1:02:19, 77.90s/it] 73%|███████▎  | 125/172 [2:56:23<1:02:52, 80.26s/it] 73%|███████▎  | 126/172 [2:57:59<1:05:07, 84.95s/it] 74%|███████▍  | 127/172 [2:59:54<1:10:32, 94.05s/it] 74%|███████▍  | 128/172 [3:01:31<1:09:38, 94.96s/it] 75%|███████▌  | 129/172 [3:03:16<1:10:06, 97.84s/it] 76%|███████▌  | 130/172 [3:04:52<1:08:13, 97.46s/it] 76%|███████▌  | 131/172 [3:06:31<1:06:54, 97.92s/it] 77%|███████▋  | 132/172 [3:08:09<1:05:08, 97.70s/it] 77%|███████▋  | 133/172 [3:09:23<59:01, 90.80s/it]   78%|███████▊  | 134/172 [3:10:57<58:04, 91.69s/it] 78%|███████▊  | 135/172 [3:12:28<56:22, 91.43s/it] 79%|███████▉  | 136/172 [3:13:43<51:56, 86.56s/it] 80%|███████▉  | 137/172 [3:15:11<50:40, 86.88s/it] 80%|████████  | 138/172 [3:16:28<47:34, 83.95s/it] 81%|████████  | 139/172 [3:17:54<46:35, 84.72s/it] 81%|████████▏ | 140/172 [3:19:21<45:25, 85.16s/it] 82%|████████▏ | 141/172 [3:20:40<43:03, 83.35s/it] 83%|████████▎ | 142/172 [3:22:06<42:11, 84.38s/it] 83%|████████▎ | 143/172 [3:23:19<39:08, 80.98s/it] 84%|████████▎ | 144/172 [3:24:31<36:26, 78.08s/it] 84%|████████▍ | 145/172 [3:25:51<35:23, 78.63s/it] 85%|████████▍ | 146/172 [3:27:28<36:32, 84.32s/it] 85%|████████▌ | 147/172 [3:29:13<37:43, 90.55s/it] 86%|████████▌ | 148/172 [3:30:37<35:20, 88.35s/it] 87%|████████▋ | 149/172 [3:32:04<33:48, 88.20s/it] 87%|████████▋ | 150/172 [3:33:25<31:30, 85.93s/it] 88%|████████▊ | 151/172 [3:34:44<29:18, 83.72s/it] 88%|████████▊ | 152/172 [3:36:24<29:32, 88.64s/it] 89%|████████▉ | 153/172 [3:38:16<30:15, 95.57s/it] 90%|████████▉ | 154/172 [3:39:56<29:06, 97.01s/it] 90%|█████████ | 155/172 [3:41:47<28:38, 101.10s/it] 91%|█████████ | 156/172 [3:43:39<27:52, 104.56s/it] 91%|█████████▏| 157/172 [3:45:16<25:34, 102.28s/it] 92%|█████████▏| 158/172 [3:46:56<23:40, 101.50s/it] 92%|█████████▏| 159/172 [3:49:00<23:27, 108.26s/it] 93%|█████████▎| 160/172 [3:51:11<23:03, 115.26s/it] 94%|█████████▎| 161/172 [3:53:12<21:25, 116.83s/it] 94%|█████████▍| 162/172 [3:54:58<18:56, 113.66s/it] 95%|█████████▍| 163/172 [3:56:46<16:48, 112.05s/it] 95%|█████████▌| 164/172 [3:59:13<16:18, 122.31s/it] 96%|█████████▌| 165/172 [4:01:06<13:57, 119.67s/it] 97%|█████████▋| 166/172 [4:02:46<11:22, 113.82s/it] 97%|█████████▋| 167/172 [4:04:16<08:52, 106.42s/it] 98%|█████████▊| 168/172 [4:06:07<07:11, 107.83s/it] 98%|█████████▊| 169/172 [4:08:26<05:52, 117.41s/it] 99%|█████████▉| 170/172 [4:10:51<04:10, 125.41s/it] 99%|█████████▉| 171/172 [4:12:33<01:58, 118.67s/it]100%|██████████| 172/172 [4:12:54<00:00, 89.27s/it] 100%|██████████| 172/172 [4:12:54<00:00, 88.22s/it]
Total: 10955
08/06/2024 17:38:00 - INFO - __main__ -     bleu-4 = 17.99 
08/06/2024 17:38:00 - INFO - __main__ -     ********************
08/06/2024 17:38:00 - INFO - __main__ -   Average inference time: 88.20053584076638
