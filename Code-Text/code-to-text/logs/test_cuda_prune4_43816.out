07/24/2024 01:15:36 - INFO - __main__ -   Namespace(model_type='roberta', model_name_or_path='microsoft/codebert-base', output_dir='model/java', load_model_path='model/java/checkpoint-best-bleu/pytorch_model.bin', train_filename=None, dev_filename=None, test_filename='../dataset/java/test.jsonl', config_name='', tokenizer_name='', max_source_length=256, max_target_length=128, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, quantize=False, quantize4=False, quantizef8=False, prune=False, prune4=True, prune6=False, do_retrain=False, train_batch_size=8, eval_batch_size=64, gradient_accumulation_steps=1, learning_rate=5e-05, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=3, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=0, local_rank=-1, seed=42, job_id='43816', file_len=300)
07/24/2024 01:15:36 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False
07/24/2024 01:15:41 - INFO - __main__ -   reload model from model/java/checkpoint-best-bleu/pytorch_model.bin
07/24/2024 01:15:47 - INFO - __main__ -   Apply model pruning 0.4
07/24/2024 01:15:51 - INFO - __main__ -   Size (MB): 706.91481
07/24/2024 01:15:51 - INFO - __main__ -   Test file: ../dataset/java/test.jsonl
  0%|          | 0/172 [00:00<?, ?it/s]/NFSHOME/gdaloisio/code/CodeXGLUE/Code-Text/code-to-text/code/model.py:114: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:78.)
  self.scores = self.tt.FloatTensor(size).zero_()
  1%|          | 1/172 [01:46<5:03:54, 106.63s/it]  1%|          | 2/172 [02:42<3:37:36, 76.80s/it]   2%|▏         | 3/172 [03:48<3:22:17, 71.82s/it]  2%|▏         | 4/172 [04:33<2:51:32, 61.27s/it]  3%|▎         | 5/172 [05:27<2:42:44, 58.47s/it]  3%|▎         | 6/172 [07:25<3:38:06, 78.83s/it]  4%|▍         | 7/172 [09:04<3:55:19, 85.57s/it]  5%|▍         | 8/172 [10:16<3:41:39, 81.10s/it]  5%|▌         | 9/172 [11:04<3:12:13, 70.76s/it]  6%|▌         | 10/172 [11:55<2:54:43, 64.71s/it]  6%|▋         | 11/172 [12:56<2:50:30, 63.54s/it]  7%|▋         | 12/172 [13:47<2:39:08, 59.68s/it]  8%|▊         | 13/172 [14:59<2:47:58, 63.38s/it]  8%|▊         | 14/172 [16:39<3:16:32, 74.63s/it]  9%|▊         | 15/172 [17:38<3:02:27, 69.73s/it]  9%|▉         | 16/172 [19:03<3:13:29, 74.42s/it] 10%|▉         | 17/172 [19:49<2:49:53, 65.76s/it] 10%|█         | 18/172 [21:18<3:06:55, 72.83s/it] 11%|█         | 19/172 [22:25<3:01:18, 71.10s/it] 12%|█▏        | 20/172 [23:23<2:50:30, 67.31s/it] 12%|█▏        | 21/172 [24:16<2:38:34, 63.01s/it] 13%|█▎        | 22/172 [24:56<2:19:49, 55.93s/it] 13%|█▎        | 23/172 [25:59<2:23:53, 57.95s/it] 14%|█▍        | 24/172 [26:36<2:08:08, 51.95s/it] 15%|█▍        | 25/172 [27:35<2:12:02, 53.90s/it] 15%|█▌        | 26/172 [28:54<2:29:45, 61.54s/it] 16%|█▌        | 27/172 [29:40<2:17:27, 56.88s/it] 16%|█▋        | 28/172 [30:37<2:16:16, 56.78s/it] 17%|█▋        | 29/172 [31:16<2:02:59, 51.60s/it] 17%|█▋        | 30/172 [32:14<2:06:10, 53.31s/it] 18%|█▊        | 31/172 [32:56<1:57:25, 49.97s/it] 19%|█▊        | 32/172 [33:51<2:00:10, 51.50s/it] 19%|█▉        | 33/172 [35:05<2:14:49, 58.20s/it] 20%|█▉        | 34/172 [35:48<2:03:35, 53.74s/it] 20%|██        | 35/172 [36:32<1:55:49, 50.72s/it] 21%|██        | 36/172 [37:08<1:44:51, 46.26s/it] 22%|██▏       | 37/172 [37:57<1:45:56, 47.08s/it] 22%|██▏       | 38/172 [38:38<1:41:38, 45.51s/it] 23%|██▎       | 39/172 [39:30<1:44:38, 47.21s/it] 23%|██▎       | 40/172 [40:16<1:43:13, 46.92s/it] 24%|██▍       | 41/172 [41:31<2:01:10, 55.50s/it] 24%|██▍       | 42/172 [42:41<2:09:23, 59.72s/it] 25%|██▌       | 43/172 [43:33<2:03:41, 57.53s/it] 26%|██▌       | 44/172 [44:55<2:17:51, 64.62s/it] 26%|██▌       | 45/172 [46:29<2:35:51, 73.63s/it] 27%|██▋       | 46/172 [47:55<2:42:24, 77.34s/it] 27%|██▋       | 47/172 [48:39<2:20:25, 67.40s/it] 28%|██▊       | 48/172 [49:32<2:10:17, 63.05s/it] 28%|██▊       | 49/172 [50:05<1:50:16, 53.80s/it] 29%|██▉       | 50/172 [51:08<1:55:25, 56.77s/it] 30%|██▉       | 51/172 [52:04<1:53:56, 56.50s/it] 30%|███       | 52/172 [52:53<1:48:17, 54.15s/it] 31%|███       | 53/172 [53:50<1:49:16, 55.10s/it] 31%|███▏      | 54/172 [55:29<2:14:21, 68.31s/it] 32%|███▏      | 55/172 [56:16<2:00:42, 61.90s/it] 33%|███▎      | 56/172 [57:14<1:57:18, 60.67s/it] 33%|███▎      | 57/172 [58:12<1:55:02, 60.02s/it] 34%|███▎      | 58/172 [59:25<2:01:26, 63.92s/it] 34%|███▍      | 59/172 [1:00:45<2:09:14, 68.62s/it] 35%|███▍      | 60/172 [1:01:35<1:57:26, 62.92s/it] 35%|███▌      | 61/172 [1:03:10<2:14:13, 72.55s/it] 36%|███▌      | 62/172 [1:04:44<2:24:47, 78.98s/it] 37%|███▋      | 63/172 [1:05:45<2:13:44, 73.62s/it] 37%|███▋      | 64/172 [1:06:44<2:04:45, 69.31s/it] 38%|███▊      | 65/172 [1:07:36<1:54:18, 64.10s/it] 38%|███▊      | 66/172 [1:08:29<1:47:37, 60.92s/it] 39%|███▉      | 67/172 [1:09:20<1:41:05, 57.77s/it] 40%|███▉      | 68/172 [1:10:24<1:43:11, 59.53s/it] 40%|████      | 69/172 [1:11:03<1:31:52, 53.52s/it] 41%|████      | 70/172 [1:12:01<1:33:06, 54.77s/it] 41%|████▏     | 71/172 [1:12:38<1:23:08, 49.39s/it] 42%|████▏     | 72/172 [1:13:13<1:15:13, 45.14s/it] 42%|████▏     | 73/172 [1:14:12<1:21:30, 49.40s/it] 43%|████▎     | 74/172 [1:15:31<1:35:03, 58.20s/it] 44%|████▎     | 75/172 [1:16:15<1:27:15, 53.97s/it] 44%|████▍     | 76/172 [1:17:04<1:23:56, 52.46s/it] 45%|████▍     | 77/172 [1:17:47<1:18:42, 49.72s/it] 45%|████▌     | 78/172 [1:18:38<1:18:10, 49.90s/it] 46%|████▌     | 79/172 [1:19:20<1:13:56, 47.70s/it] 47%|████▋     | 80/172 [1:20:14<1:15:49, 49.45s/it] 47%|████▋     | 81/172 [1:21:00<1:13:23, 48.39s/it] 48%|████▊     | 82/172 [1:21:36<1:07:23, 44.93s/it] 48%|████▊     | 83/172 [1:22:15<1:03:51, 43.05s/it] 49%|████▉     | 84/172 [1:22:53<1:00:56, 41.55s/it] 49%|████▉     | 85/172 [1:23:46<1:05:15, 45.00s/it] 50%|█████     | 86/172 [1:24:19<59:14, 41.33s/it]   51%|█████     | 87/172 [1:24:54<55:56, 39.48s/it] 51%|█████     | 88/172 [1:25:37<56:44, 40.53s/it] 52%|█████▏    | 89/172 [1:26:12<53:41, 38.81s/it] 52%|█████▏    | 90/172 [1:26:56<55:23, 40.53s/it] 53%|█████▎    | 91/172 [1:27:56<1:02:17, 46.15s/it] 53%|█████▎    | 92/172 [1:28:54<1:06:12, 49.66s/it] 54%|█████▍    | 93/172 [1:29:39<1:03:41, 48.38s/it] 55%|█████▍    | 94/172 [1:30:10<56:13, 43.26s/it]   55%|█████▌    | 95/172 [1:30:43<51:35, 40.21s/it] 56%|█████▌    | 96/172 [1:31:15<47:31, 37.52s/it] 56%|█████▋    | 97/172 [1:32:00<49:45, 39.81s/it] 57%|█████▋    | 98/172 [1:32:53<53:56, 43.74s/it] 58%|█████▊    | 99/172 [1:34:02<1:02:35, 51.44s/it] 58%|█████▊    | 100/172 [1:34:35<54:55, 45.78s/it]  59%|█████▊    | 101/172 [1:35:18<53:11, 44.95s/it] 59%|█████▉    | 102/172 [1:36:01<51:56, 44.52s/it] 60%|█████▉    | 103/172 [1:36:51<53:09, 46.22s/it] 60%|██████    | 104/172 [1:37:45<54:57, 48.50s/it] 61%|██████    | 105/172 [1:39:33<1:14:08, 66.39s/it] 62%|██████▏   | 106/172 [1:40:44<1:14:36, 67.82s/it] 62%|██████▏   | 107/172 [1:41:48<1:12:11, 66.63s/it] 63%|██████▎   | 108/172 [1:42:36<1:04:59, 60.94s/it] 63%|██████▎   | 109/172 [1:43:50<1:08:00, 64.77s/it] 64%|██████▍   | 110/172 [1:44:33<1:00:14, 58.30s/it] 65%|██████▍   | 111/172 [1:45:34<1:00:12, 59.22s/it] 65%|██████▌   | 112/172 [1:46:27<57:19, 57.32s/it]   66%|██████▌   | 113/172 [1:47:14<53:15, 54.15s/it] 66%|██████▋   | 114/172 [1:48:05<51:35, 53.38s/it] 67%|██████▋   | 115/172 [1:49:18<56:08, 59.09s/it] 67%|██████▋   | 116/172 [1:50:01<50:48, 54.44s/it] 68%|██████▊   | 117/172 [1:50:39<45:20, 49.46s/it] 69%|██████▊   | 118/172 [1:52:04<54:00, 60.00s/it] 69%|██████▉   | 119/172 [1:53:06<53:40, 60.77s/it] 70%|██████▉   | 120/172 [1:54:05<52:03, 60.07s/it] 70%|███████   | 121/172 [1:55:00<49:52, 58.68s/it] 71%|███████   | 122/172 [1:56:03<49:58, 59.98s/it] 72%|███████▏  | 123/172 [1:56:58<47:41, 58.39s/it] 72%|███████▏  | 124/172 [1:57:50<45:09, 56.45s/it] 73%|███████▎  | 125/172 [1:58:46<44:11, 56.41s/it] 73%|███████▎  | 126/172 [1:59:50<44:53, 58.56s/it] 74%|███████▍  | 127/172 [2:00:50<44:14, 59.00s/it] 74%|███████▍  | 128/172 [2:01:25<37:54, 51.69s/it] 75%|███████▌  | 129/172 [2:02:30<40:02, 55.87s/it] 76%|███████▌  | 130/172 [2:03:22<38:17, 54.69s/it] 76%|███████▌  | 131/172 [2:04:29<39:56, 58.44s/it] 77%|███████▋  | 132/172 [2:05:18<37:00, 55.50s/it] 77%|███████▋  | 133/172 [2:05:48<31:12, 48.01s/it] 78%|███████▊  | 134/172 [2:06:56<34:03, 53.77s/it] 78%|███████▊  | 135/172 [2:07:32<29:58, 48.62s/it] 79%|███████▉  | 136/172 [2:08:13<27:49, 46.37s/it] 80%|███████▉  | 137/172 [2:09:03<27:35, 47.30s/it] 80%|████████  | 138/172 [2:09:53<27:22, 48.30s/it] 81%|████████  | 139/172 [2:10:44<26:56, 48.99s/it] 81%|████████▏ | 140/172 [2:11:17<23:29, 44.06s/it] 82%|████████▏ | 141/172 [2:12:31<27:31, 53.27s/it] 83%|████████▎ | 142/172 [2:14:52<39:46, 79.54s/it] 83%|████████▎ | 143/172 [2:15:39<33:45, 69.84s/it] 84%|████████▎ | 144/172 [2:16:13<27:31, 58.99s/it] 84%|████████▍ | 145/172 [2:17:17<27:13, 60.49s/it] 85%|████████▍ | 146/172 [2:18:15<25:54, 59.79s/it] 85%|████████▌ | 147/172 [2:19:03<23:26, 56.25s/it] 86%|████████▌ | 148/172 [2:20:04<23:00, 57.54s/it] 87%|████████▋ | 149/172 [2:21:08<22:51, 59.61s/it] 87%|████████▋ | 150/172 [2:21:50<19:54, 54.30s/it] 88%|████████▊ | 151/172 [2:23:12<21:52, 62.52s/it] 88%|████████▊ | 152/172 [2:24:06<20:02, 60.13s/it] 89%|████████▉ | 153/172 [2:24:52<17:38, 55.70s/it] 90%|████████▉ | 154/172 [2:25:09<13:16, 44.24s/it] 90%|█████████ | 155/172 [2:25:35<11:00, 38.83s/it] 91%|█████████ | 156/172 [2:26:41<12:30, 46.93s/it] 91%|█████████▏| 157/172 [2:28:01<14:12, 56.82s/it] 92%|█████████▏| 158/172 [2:28:57<13:11, 56.51s/it] 92%|█████████▏| 159/172 [2:29:58<12:33, 57.99s/it] 93%|█████████▎| 160/172 [2:30:48<11:04, 55.34s/it] 94%|█████████▎| 161/172 [2:31:35<09:43, 53.07s/it] 94%|█████████▍| 162/172 [2:32:56<10:12, 61.26s/it] 95%|█████████▍| 163/172 [2:34:07<09:38, 64.30s/it] 95%|█████████▌| 164/172 [2:35:46<09:56, 74.53s/it] 96%|█████████▌| 165/172 [2:36:49<08:18, 71.16s/it] 97%|█████████▋| 166/172 [2:37:38<06:28, 64.71s/it] 97%|█████████▋| 167/172 [2:39:11<06:04, 72.91s/it] 98%|█████████▊| 168/172 [2:39:55<04:17, 64.48s/it] 98%|█████████▊| 169/172 [2:40:50<03:04, 61.64s/it] 99%|█████████▉| 170/172 [2:42:08<02:13, 66.53s/it] 99%|█████████▉| 171/172 [2:42:50<00:59, 59.22s/it]100%|██████████| 172/172 [2:42:57<00:00, 43.38s/it]100%|██████████| 172/172 [2:42:57<00:00, 56.85s/it]
Total: 10955
07/24/2024 03:59:03 - INFO - __main__ -     bleu-4 = 6.27 
07/24/2024 03:59:03 - INFO - __main__ -     ********************
07/24/2024 03:59:03 - INFO - __main__ -   Average inference time: 56.81934456631195
