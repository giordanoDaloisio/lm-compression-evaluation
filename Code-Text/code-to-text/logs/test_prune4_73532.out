No CUDA runtime is found, using CUDA_HOME='/usr/local/cuda'
08/06/2024 17:39:15 - INFO - __main__ -   Namespace(model_type='roberta', model_name_or_path='microsoft/codebert-base', output_dir='model/java', load_model_path='model/java/checkpoint-best-bleu/pytorch_model.bin', train_filename=None, dev_filename=None, test_filename='../dataset/java/test.jsonl', config_name='', tokenizer_name='', max_source_length=256, max_target_length=128, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=True, quantize=False, quantize4=False, quantizef8=False, prune=False, prune4=True, prune6=False, do_retrain=False, train_batch_size=8, eval_batch_size=64, gradient_accumulation_steps=1, learning_rate=5e-05, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=3, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=0, local_rank=-1, seed=42, job_id='73532', file_len=300)
08/06/2024 17:39:15 - WARNING - __main__ -   Process rank: -1, device: cpu, n_gpu: 2, distributed training: False
08/06/2024 17:39:19 - INFO - __main__ -   reload model from model/java/checkpoint-best-bleu/pytorch_model.bin
08/06/2024 17:39:24 - INFO - __main__ -   Apply model pruning 0.4
08/06/2024 17:39:33 - INFO - __main__ -   Size (MB): 706.910458
08/06/2024 17:39:33 - INFO - __main__ -   Test file: ../dataset/java/test.jsonl
  0%|          | 0/172 [00:00<?, ?it/s]  1%|          | 1/172 [07:10<20:26:29, 430.35s/it]  1%|          | 2/172 [11:15<15:09:52, 321.14s/it]  2%|▏         | 3/172 [15:35<13:45:51, 293.21s/it]  2%|▏         | 4/172 [19:07<12:11:44, 261.33s/it]  3%|▎         | 5/172 [22:40<11:19:06, 243.99s/it]  3%|▎         | 6/172 [30:12<14:30:04, 314.49s/it]  4%|▍         | 7/172 [36:42<15:33:00, 339.28s/it]  5%|▍         | 8/172 [41:41<14:52:11, 326.41s/it]  5%|▌         | 9/172 [45:16<13:12:20, 291.66s/it]  6%|▌         | 10/172 [48:39<11:53:25, 264.23s/it]  6%|▋         | 11/172 [53:35<12:15:15, 274.01s/it]  7%|▋         | 12/172 [57:47<11:53:09, 267.44s/it]  8%|▊         | 13/172 [1:03:30<12:49:12, 290.27s/it]  8%|▊         | 14/172 [1:10:33<14:30:05, 330.41s/it]  9%|▊         | 15/172 [1:14:16<12:59:21, 297.85s/it]  9%|▉         | 16/172 [1:20:28<13:52:44, 320.29s/it] 10%|▉         | 17/172 [1:24:29<12:45:38, 296.38s/it] 10%|█         | 18/172 [1:30:59<13:53:04, 324.58s/it] 11%|█         | 19/172 [1:36:10<13:37:09, 320.45s/it] 12%|█▏        | 20/172 [1:40:28<12:44:25, 301.75s/it] 12%|█▏        | 21/172 [1:44:07<11:36:38, 276.81s/it] 13%|█▎        | 22/172 [1:47:30<10:36:34, 254.63s/it] 13%|█▎        | 23/172 [1:52:30<11:06:16, 268.30s/it] 14%|█▍        | 24/172 [1:55:09<9:40:41, 235.42s/it]  15%|█▍        | 25/172 [1:59:37<10:00:41, 245.18s/it] 15%|█▌        | 26/172 [2:05:41<11:23:58, 281.08s/it] 16%|█▌        | 27/172 [2:09:28<10:39:38, 264.68s/it] 16%|█▋        | 28/172 [2:13:45<10:29:52, 262.45s/it] 17%|█▋        | 29/172 [2:16:20<9:08:19, 230.07s/it]  17%|█▋        | 30/172 [2:20:22<9:13:16, 233.78s/it] 18%|█▊        | 31/172 [2:23:20<8:30:18, 217.15s/it] 19%|█▊        | 32/172 [2:27:05<8:31:46, 219.33s/it] 19%|█▉        | 33/172 [2:31:46<9:11:21, 238.00s/it] 20%|█▉        | 34/172 [2:34:21<8:09:43, 212.92s/it] 20%|██        | 35/172 [2:37:21<7:43:32, 203.01s/it] 21%|██        | 36/172 [2:39:26<6:47:11, 179.65s/it] 22%|██▏       | 37/172 [2:42:09<6:33:03, 174.69s/it] 22%|██▏       | 38/172 [2:44:31<6:08:00, 164.78s/it] 23%|██▎       | 39/172 [2:47:24<6:11:06, 167.41s/it] 23%|██▎       | 40/172 [2:50:08<6:06:06, 166.42s/it] 24%|██▍       | 41/172 [2:54:21<6:59:50, 192.30s/it] 24%|██▍       | 42/172 [2:58:19<7:26:26, 206.05s/it] 25%|██▌       | 43/172 [3:01:24<7:09:15, 199.66s/it] 26%|██▌       | 44/172 [3:06:12<8:02:45, 226.29s/it] 26%|██▌       | 45/172 [3:11:32<8:58:20, 254.33s/it] 27%|██▋       | 46/172 [3:16:21<9:16:13, 264.87s/it] 27%|██▋       | 47/172 [3:18:45<7:56:17, 228.62s/it] 28%|██▊       | 48/172 [3:21:53<7:26:54, 216.25s/it] 28%|██▊       | 49/172 [3:23:42<6:17:17, 184.05s/it] 29%|██▉       | 50/172 [3:27:17<6:33:03, 193.31s/it] 30%|██▉       | 51/172 [3:30:10<6:17:29, 187.18s/it] 30%|███       | 52/172 [3:32:53<5:59:55, 179.96s/it] 31%|███       | 53/172 [3:36:45<6:28:15, 195.76s/it] 31%|███▏      | 54/172 [3:42:16<7:44:37, 236.25s/it] 32%|███▏      | 55/172 [3:44:40<6:46:53, 208.66s/it] 33%|███▎      | 56/172 [3:47:40<6:26:29, 199.91s/it] 33%|███▎      | 57/172 [3:50:47<6:15:50, 196.09s/it] 34%|███▎      | 58/172 [3:54:57<6:43:05, 212.16s/it] 34%|███▍      | 59/172 [3:59:14<7:05:23, 225.87s/it] 35%|███▍      | 60/172 [4:02:07<6:31:50, 209.92s/it] 35%|███▌      | 61/172 [4:09:11<8:27:11, 274.16s/it] 36%|███▌      | 62/172 [4:14:14<8:38:25, 282.78s/it] 37%|███▋      | 63/172 [4:17:23<7:42:31, 254.60s/it] 37%|███▋      | 64/172 [4:20:31<7:02:05, 234.49s/it] 38%|███▊      | 65/172 [4:23:09<6:17:30, 211.69s/it] 38%|███▊      | 66/172 [4:26:48<6:17:47, 213.84s/it] 39%|███▉      | 67/172 [4:29:29<5:46:27, 197.98s/it] 40%|███▉      | 68/172 [4:33:00<5:50:01, 201.93s/it] 40%|████      | 69/172 [4:35:04<5:06:45, 178.69s/it] 41%|████      | 70/172 [4:38:17<5:10:51, 182.86s/it] 41%|████▏     | 71/172 [4:40:19<4:36:55, 164.51s/it] 42%|████▏     | 72/172 [4:42:09<4:06:56, 148.16s/it] 42%|████▏     | 73/172 [4:45:22<4:26:45, 161.67s/it] 43%|████▎     | 74/172 [4:49:27<5:04:52, 186.66s/it] 44%|████▎     | 75/172 [4:51:44<4:37:46, 171.82s/it] 44%|████▍     | 76/172 [4:54:37<4:35:38, 172.27s/it] 45%|████▍     | 77/172 [4:57:22<4:29:09, 170.00s/it] 45%|████▌     | 78/172 [5:00:30<4:34:48, 175.41s/it] 46%|████▌     | 79/172 [5:03:20<4:29:08, 173.64s/it] 47%|████▋     | 80/172 [5:06:21<4:29:44, 175.92s/it] 47%|████▋     | 81/172 [5:09:26<4:30:52, 178.60s/it] 48%|████▊     | 82/172 [5:11:38<4:07:03, 164.71s/it] 48%|████▊     | 83/172 [5:14:10<3:58:50, 161.01s/it] 49%|████▉     | 84/172 [5:16:31<3:47:18, 154.98s/it] 49%|████▉     | 85/172 [5:20:00<4:07:55, 170.98s/it] 50%|█████     | 86/172 [5:22:06<3:45:53, 157.60s/it] 51%|█████     | 87/172 [5:24:44<3:43:25, 157.71s/it] 51%|█████     | 88/172 [5:27:25<3:42:05, 158.64s/it] 52%|█████▏    | 89/172 [5:29:21<3:21:48, 145.88s/it] 52%|█████▏    | 90/172 [5:31:56<3:22:56, 148.49s/it] 53%|█████▎    | 91/172 [5:36:14<4:05:03, 181.52s/it] 53%|█████▎    | 92/172 [5:41:02<4:44:35, 213.44s/it] 54%|█████▍    | 93/172 [5:44:12<4:31:53, 206.50s/it] 55%|█████▍    | 94/172 [5:46:37<4:04:14, 187.87s/it] 55%|█████▌    | 95/172 [5:49:17<3:50:18, 179.45s/it] 56%|█████▌    | 96/172 [5:51:37<3:32:18, 167.61s/it] 56%|█████▋    | 97/172 [5:54:49<3:38:54, 175.13s/it] 57%|█████▋    | 98/172 [5:58:56<4:02:25, 196.56s/it] 58%|█████▊    | 99/172 [6:04:04<4:39:51, 230.02s/it] 58%|█████▊    | 100/172 [6:06:35<4:07:40, 206.39s/it] 59%|█████▊    | 101/172 [6:09:55<4:01:50, 204.37s/it] 59%|█████▉    | 102/172 [6:13:01<3:52:11, 199.02s/it] 60%|█████▉    | 103/172 [6:16:41<3:55:54, 205.14s/it] 60%|██████    | 104/172 [6:20:34<4:01:57, 213.49s/it] 61%|██████    | 105/172 [6:28:25<5:24:36, 290.70s/it] 62%|██████▏   | 106/172 [6:33:06<5:16:35, 287.81s/it] 62%|██████▏   | 107/172 [6:38:17<5:19:23, 294.83s/it] 63%|██████▎   | 108/172 [6:41:37<4:44:12, 266.44s/it] 63%|██████▎   | 109/172 [6:47:12<5:01:29, 287.14s/it] 64%|██████▍   | 110/172 [6:50:35<4:30:28, 261.76s/it] 65%|██████▍   | 111/172 [6:55:23<4:34:00, 269.51s/it] 65%|██████▌   | 112/172 [6:59:27<4:21:54, 261.91s/it] 66%|██████▌   | 113/172 [7:03:22<4:09:40, 253.91s/it] 66%|██████▋   | 114/172 [7:07:09<3:57:32, 245.74s/it] 67%|██████▋   | 115/172 [7:13:15<4:27:42, 281.79s/it] 67%|██████▋   | 116/172 [7:16:25<3:57:32, 254.50s/it] 68%|██████▊   | 117/172 [7:19:32<3:34:40, 234.19s/it] 69%|██████▊   | 118/172 [7:26:42<4:23:37, 292.91s/it] 69%|██████▉   | 119/172 [7:31:28<4:16:58, 290.92s/it] 70%|██████▉   | 120/172 [7:35:53<4:05:13, 282.95s/it] 70%|███████   | 121/172 [7:40:15<3:55:08, 276.64s/it] 71%|███████   | 122/172 [7:44:49<3:50:02, 276.06s/it] 72%|███████▏  | 123/172 [7:48:49<3:36:24, 265.00s/it] 72%|███████▏  | 124/172 [7:52:36<3:22:59, 253.74s/it] 73%|███████▎  | 125/172 [7:57:06<3:22:26, 258.45s/it] 73%|███████▎  | 126/172 [8:02:04<3:27:20, 270.45s/it] 74%|███████▍  | 127/172 [8:06:05<3:16:14, 261.65s/it] 74%|███████▍  | 128/172 [8:09:15<2:56:04, 240.09s/it] 75%|███████▌  | 129/172 [8:15:41<3:23:25, 283.85s/it] 76%|███████▌  | 130/172 [8:19:24<3:05:59, 265.69s/it] 76%|███████▌  | 131/172 [8:23:56<3:02:55, 267.69s/it] 77%|███████▋  | 132/172 [8:27:24<2:46:23, 249.59s/it] 77%|███████▋  | 133/172 [8:29:26<2:17:19, 211.27s/it] 78%|███████▊  | 134/172 [8:33:36<2:21:14, 223.02s/it] 78%|███████▊  | 135/172 [8:35:56<2:02:11, 198.16s/it] 79%|███████▉  | 136/172 [8:38:36<1:51:58, 186.62s/it] 80%|███████▉  | 137/172 [8:42:12<1:53:58, 195.39s/it] 80%|████████  | 138/172 [8:45:15<1:48:41, 191.81s/it] 81%|████████  | 139/172 [8:48:41<1:47:51, 196.09s/it] 81%|████████▏ | 140/172 [8:50:41<1:32:22, 173.20s/it] 82%|████████▏ | 141/172 [8:55:39<1:48:51, 210.70s/it] 83%|████████▎ | 142/172 [9:05:29<2:42:11, 324.38s/it] 83%|████████▎ | 143/172 [9:08:33<2:16:27, 282.33s/it] 84%|████████▎ | 144/172 [9:10:34<1:49:04, 233.73s/it] 84%|████████▍ | 145/172 [9:14:15<1:43:34, 230.15s/it] 85%|████████▍ | 146/172 [9:17:56<1:38:27, 227.23s/it] 85%|████████▌ | 147/172 [9:20:39<1:26:41, 208.05s/it] 86%|████████▌ | 148/172 [9:24:42<1:27:26, 218.60s/it] 87%|████████▋ | 149/172 [9:28:29<1:24:46, 221.15s/it] 87%|████████▋ | 150/172 [9:30:50<1:12:12, 196.92s/it] 88%|████████▊ | 151/172 [9:35:25<1:17:08, 220.38s/it] 88%|████████▊ | 152/172 [9:38:55<1:12:24, 217.23s/it] 89%|████████▉ | 153/172 [9:41:53<1:05:06, 205.61s/it] 90%|████████▉ | 154/172 [9:43:02<49:23, 164.64s/it]   90%|█████████ | 155/172 [9:44:43<41:14, 145.59s/it] 91%|█████████ | 156/172 [9:48:57<47:25, 177.85s/it] 91%|█████████▏| 157/172 [9:54:12<54:45, 219.03s/it] 92%|█████████▏| 158/172 [9:58:12<52:36, 225.50s/it] 92%|█████████▏| 159/172 [10:01:34<47:18, 218.31s/it] 93%|█████████▎| 160/172 [10:04:10<39:54, 199.57s/it] 94%|█████████▎| 161/172 [10:06:42<34:00, 185.52s/it] 94%|█████████▍| 162/172 [10:11:09<34:59, 209.97s/it] 95%|█████████▍| 163/172 [10:15:11<32:55, 219.53s/it] 95%|█████████▌| 164/172 [10:20:37<33:30, 251.27s/it] 96%|█████████▌| 165/172 [10:24:24<28:29, 244.15s/it] 97%|█████████▋| 166/172 [10:27:04<21:53, 218.98s/it] 97%|█████████▋| 167/172 [10:33:11<21:56, 263.37s/it] 98%|█████████▊| 168/172 [10:35:40<15:15, 229.00s/it] 98%|█████████▊| 169/172 [10:38:44<10:46, 215.44s/it] 99%|█████████▉| 170/172 [10:42:44<07:25, 222.97s/it] 99%|█████████▉| 171/172 [10:44:56<03:15, 195.58s/it]100%|██████████| 172/172 [10:45:15<00:00, 142.63s/it]100%|██████████| 172/172 [10:45:15<00:00, 225.09s/it]
Total: 10955
08/07/2024 04:25:04 - INFO - __main__ -     bleu-4 = 6.27 
08/07/2024 04:25:04 - INFO - __main__ -     ********************
08/07/2024 04:25:04 - INFO - __main__ -   Average inference time: 225.06107818664506
