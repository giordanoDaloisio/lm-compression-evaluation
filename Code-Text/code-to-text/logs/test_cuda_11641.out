07/08/2024 12:18:50 - INFO - __main__ -   Namespace(model_type='roberta', model_name_or_path='microsoft/codebert-base', output_dir='model/java', load_model_path='model/java/checkpoint-best-bleu/pytorch_model.bin', train_filename=None, dev_filename='../dataset/java/valid.jsonl', test_filename='../dataset/java/test.jsonl', config_name='', tokenizer_name='', max_source_length=256, max_target_length=128, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, quantize=False, prune=False, train_batch_size=8, eval_batch_size=64, gradient_accumulation_steps=1, learning_rate=5e-05, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=3, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=0, local_rank=-1, seed=42, job_id='11641', file_len=None)
07/08/2024 12:18:50 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False
07/08/2024 12:18:55 - INFO - __main__ -   reload model from model/java/checkpoint-best-bleu/pytorch_model.bin
07/08/2024 12:18:57 - INFO - __main__ -   Size (MB): 706.91481
07/08/2024 12:18:59 - INFO - __main__ -   Test file: ../dataset/java/valid.jsonl

  0%|          | 0/81 [00:00<?, ?it/s]/NFSHOME/gdaloisio/code/CodeXGLUE/Code-Text/code-to-text/code/model.py:114: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:78.)
  self.scores = self.tt.FloatTensor(size).zero_()

  1%|          | 1/81 [00:29<39:31, 29.64s/it]
  2%|▏         | 2/81 [01:00<39:47, 30.23s/it]
  4%|▎         | 3/81 [01:33<40:55, 31.48s/it]
  5%|▍         | 4/81 [02:01<38:51, 30.28s/it]
  6%|▌         | 5/81 [02:24<35:09, 27.76s/it]
  7%|▋         | 6/81 [02:48<32:48, 26.25s/it]
  9%|▊         | 7/81 [03:13<32:05, 26.02s/it]
 10%|▉         | 8/81 [03:38<31:14, 25.67s/it]
 11%|█         | 9/81 [04:02<30:07, 25.11s/it]
 12%|█▏        | 10/81 [04:26<29:08, 24.62s/it]
 14%|█▎        | 11/81 [04:50<28:42, 24.60s/it]
 15%|█▍        | 12/81 [05:16<28:35, 24.87s/it]
 16%|█▌        | 13/81 [05:44<29:11, 25.76s/it]
 17%|█▋        | 14/81 [06:08<28:10, 25.23s/it]
 19%|█▊        | 15/81 [06:31<27:17, 24.81s/it]
 20%|█▉        | 16/81 [06:55<26:29, 24.46s/it]
 21%|██        | 17/81 [07:19<25:58, 24.36s/it]
 22%|██▏       | 18/81 [07:51<28:00, 26.68s/it]
 23%|██▎       | 19/81 [08:14<26:22, 25.53s/it]
 25%|██▍       | 20/81 [08:39<25:40, 25.25s/it]
 26%|██▌       | 21/81 [09:03<25:06, 25.11s/it]
 27%|██▋       | 22/81 [09:33<25:56, 26.39s/it]
 28%|██▊       | 23/81 [10:01<26:02, 26.94s/it]
 30%|██▉       | 24/81 [10:25<24:36, 25.91s/it]
 31%|███       | 25/81 [10:53<24:56, 26.72s/it]
 32%|███▏      | 26/81 [11:14<22:53, 24.98s/it]
 33%|███▎      | 27/81 [11:36<21:36, 24.00s/it]
 35%|███▍      | 28/81 [11:58<20:42, 23.44s/it]
 36%|███▌      | 29/81 [12:26<21:36, 24.94s/it]
 37%|███▋      | 30/81 [12:50<20:47, 24.45s/it]
 38%|███▊      | 31/81 [13:12<19:50, 23.80s/it]
 40%|███▉      | 32/81 [13:34<19:05, 23.37s/it]
 41%|████      | 33/81 [13:58<18:42, 23.39s/it]
 42%|████▏     | 34/81 [14:23<18:52, 24.09s/it]
 43%|████▎     | 35/81 [14:48<18:30, 24.14s/it]
 44%|████▍     | 36/81 [15:12<18:09, 24.22s/it]
 46%|████▌     | 37/81 [15:38<18:12, 24.83s/it]
 47%|████▋     | 38/81 [16:06<18:23, 25.66s/it]
 48%|████▊     | 39/81 [16:35<18:37, 26.60s/it]
 49%|████▉     | 40/81 [16:58<17:30, 25.62s/it]
 51%|█████     | 41/81 [17:32<18:49, 28.25s/it]
 52%|█████▏    | 42/81 [17:58<17:53, 27.53s/it]
 53%|█████▎    | 43/81 [18:22<16:46, 26.48s/it]
 54%|█████▍    | 44/81 [18:43<15:11, 24.64s/it]
 56%|█████▌    | 45/81 [19:04<14:15, 23.76s/it]
 57%|█████▋    | 46/81 [19:27<13:43, 23.53s/it]
 58%|█████▊    | 47/81 [19:53<13:37, 24.05s/it]
 59%|█████▉    | 48/81 [20:16<13:11, 23.98s/it]
 60%|██████    | 49/81 [20:43<13:09, 24.67s/it]
 62%|██████▏   | 50/81 [21:08<12:48, 24.78s/it]
 63%|██████▎   | 51/81 [21:30<11:57, 23.93s/it]
 64%|██████▍   | 52/81 [21:54<11:39, 24.13s/it]
 65%|██████▌   | 53/81 [22:18<11:12, 24.02s/it]
 67%|██████▋   | 54/81 [22:42<10:45, 23.90s/it]
 68%|██████▊   | 55/81 [23:06<10:21, 23.91s/it]
 69%|██████▉   | 56/81 [23:28<09:49, 23.57s/it]
 70%|███████   | 57/81 [24:00<10:22, 25.92s/it]
 72%|███████▏  | 58/81 [24:22<09:33, 24.93s/it]
 73%|███████▎  | 59/81 [24:45<08:51, 24.15s/it]
 74%|███████▍  | 60/81 [25:07<08:15, 23.62s/it]
 75%|███████▌  | 61/81 [25:28<07:37, 22.86s/it]
 77%|███████▋  | 62/81 [25:49<07:02, 22.24s/it]
 78%|███████▊  | 63/81 [26:11<06:39, 22.20s/it]
 79%|███████▉  | 64/81 [26:33<06:17, 22.23s/it]
 80%|████████  | 65/81 [26:57<06:01, 22.62s/it]
 81%|████████▏ | 66/81 [27:22<05:50, 23.38s/it]
 83%|████████▎ | 67/81 [27:50<05:47, 24.82s/it]
 84%|████████▍ | 68/81 [28:13<05:15, 24.24s/it]
 85%|████████▌ | 69/81 [28:37<04:48, 24.08s/it]
 86%|████████▋ | 70/81 [29:10<04:55, 26.87s/it]
 88%|████████▊ | 71/81 [29:35<04:22, 26.25s/it]
 89%|████████▉ | 72/81 [30:00<03:51, 25.73s/it]
 90%|█████████ | 73/81 [30:22<03:17, 24.65s/it]
 91%|█████████▏| 74/81 [30:45<02:49, 24.17s/it]
 93%|█████████▎| 75/81 [31:08<02:23, 23.89s/it]
 94%|█████████▍| 76/81 [31:31<01:58, 23.70s/it]
 95%|█████████▌| 77/81 [31:54<01:33, 23.47s/it]
 96%|█████████▋| 78/81 [32:15<01:07, 22.57s/it]
 98%|█████████▊| 79/81 [32:37<00:45, 22.59s/it]
 99%|█████████▉| 80/81 [32:57<00:21, 21.68s/it]
100%|██████████| 81/81 [33:19<00:00, 21.95s/it]
100%|██████████| 81/81 [33:19<00:00, 24.69s/it]
Total: 5183
07/08/2024 12:52:26 - INFO - __main__ -     bleu-4 = 18.87 
07/08/2024 12:52:26 - INFO - __main__ -     ********************
07/08/2024 12:52:26 - INFO - __main__ -   Average inference time: 24.599988804923164
07/08/2024 12:52:26 - INFO - __main__ -   Test file: ../dataset/java/test.jsonl

  0%|          | 0/172 [00:00<?, ?it/s]
  1%|          | 1/172 [00:33<1:34:23, 33.12s/it]
  1%|          | 2/172 [00:57<1:18:46, 27.80s/it]
  2%|▏         | 3/172 [01:19<1:11:19, 25.32s/it]
  2%|▏         | 4/172 [01:50<1:16:49, 27.44s/it]
  3%|▎         | 5/172 [02:16<1:15:17, 27.05s/it]
  3%|▎         | 6/172 [02:48<1:19:20, 28.68s/it]
  4%|▍         | 7/172 [03:12<1:15:04, 27.30s/it]
  5%|▍         | 8/172 [03:35<1:10:37, 25.84s/it]
  5%|▌         | 9/172 [03:59<1:08:36, 25.25s/it]
  6%|▌         | 10/172 [04:21<1:05:43, 24.34s/it]
  6%|▋         | 11/172 [04:44<1:04:02, 23.87s/it]
  7%|▋         | 12/172 [05:08<1:03:14, 23.72s/it]
  8%|▊         | 13/172 [05:31<1:02:26, 23.56s/it]
  8%|▊         | 14/172 [05:55<1:02:30, 23.74s/it]
  9%|▊         | 15/172 [06:17<1:00:30, 23.13s/it]
  9%|▉         | 16/172 [06:39<59:27, 22.87s/it]  
 10%|▉         | 17/172 [07:02<59:39, 23.09s/it]
 10%|█         | 18/172 [07:25<58:49, 22.92s/it]
 11%|█         | 19/172 [07:47<57:40, 22.62s/it]
 12%|█▏        | 20/172 [08:10<57:29, 22.70s/it]
 12%|█▏        | 21/172 [08:31<56:05, 22.29s/it]
 13%|█▎        | 22/172 [08:53<55:27, 22.19s/it]
 13%|█▎        | 23/172 [09:17<56:16, 22.66s/it]
 14%|█▍        | 24/172 [09:40<56:18, 22.83s/it]
 15%|█▍        | 25/172 [10:02<54:58, 22.44s/it]
 15%|█▌        | 26/172 [10:24<54:48, 22.52s/it]
 16%|█▌        | 27/172 [10:46<53:50, 22.28s/it]
 16%|█▋        | 28/172 [11:10<54:27, 22.69s/it]
 17%|█▋        | 29/172 [11:32<53:32, 22.46s/it]
 17%|█▋        | 30/172 [11:55<54:03, 22.84s/it]
 18%|█▊        | 31/172 [12:21<55:32, 23.63s/it]
 19%|█▊        | 32/172 [12:47<56:36, 24.26s/it]
 19%|█▉        | 33/172 [13:15<58:57, 25.45s/it]
 20%|█▉        | 34/172 [13:38<57:02, 24.80s/it]
 20%|██        | 35/172 [14:02<56:17, 24.65s/it]
 21%|██        | 36/172 [14:25<54:21, 23.98s/it]
 22%|██▏       | 37/172 [14:50<54:31, 24.23s/it]
 22%|██▏       | 38/172 [15:12<53:09, 23.80s/it]
 23%|██▎       | 39/172 [15:36<52:46, 23.81s/it]
 23%|██▎       | 40/172 [15:59<51:37, 23.46s/it]
 24%|██▍       | 41/172 [16:25<53:08, 24.34s/it]
 24%|██▍       | 42/172 [16:49<52:37, 24.29s/it]
 25%|██▌       | 43/172 [17:13<51:37, 24.02s/it]
 26%|██▌       | 44/172 [17:36<50:28, 23.66s/it]
 26%|██▌       | 45/172 [17:59<50:06, 23.67s/it]
 27%|██▋       | 46/172 [18:23<49:44, 23.69s/it]
 27%|██▋       | 47/172 [18:44<47:37, 22.86s/it]
 28%|██▊       | 48/172 [19:06<46:38, 22.57s/it]
 28%|██▊       | 49/172 [19:28<45:52, 22.38s/it]
 29%|██▉       | 50/172 [19:51<46:03, 22.65s/it]
 30%|██▉       | 51/172 [20:14<45:37, 22.63s/it]
 30%|███       | 52/172 [20:35<44:28, 22.24s/it]
 31%|███       | 53/172 [21:01<46:11, 23.29s/it]
 31%|███▏      | 54/172 [21:25<46:34, 23.68s/it]
 32%|███▏      | 55/172 [21:49<46:15, 23.73s/it]
 33%|███▎      | 56/172 [22:14<46:36, 24.11s/it]
 33%|███▎      | 57/172 [22:40<47:14, 24.64s/it]
 34%|███▎      | 58/172 [23:03<45:38, 24.02s/it]
 34%|███▍      | 59/172 [23:24<43:47, 23.25s/it]
 35%|███▍      | 60/172 [23:46<42:50, 22.95s/it]
 35%|███▌      | 61/172 [24:07<40:56, 22.13s/it]
 36%|███▌      | 62/172 [24:28<40:19, 22.00s/it]
 37%|███▋      | 63/172 [24:52<40:54, 22.52s/it]
 37%|███▋      | 64/172 [25:15<40:39, 22.58s/it]
 38%|███▊      | 65/172 [25:39<41:24, 23.22s/it]
 38%|███▊      | 66/172 [26:03<41:24, 23.44s/it]
 39%|███▉      | 67/172 [26:27<41:00, 23.44s/it]
 40%|███▉      | 68/172 [26:54<42:31, 24.54s/it]
 40%|████      | 69/172 [27:18<41:39, 24.26s/it]
 41%|████      | 70/172 [27:43<42:05, 24.76s/it]
 41%|████▏     | 71/172 [28:08<41:30, 24.66s/it]
 42%|████▏     | 72/172 [28:32<40:47, 24.48s/it]
 42%|████▏     | 73/172 [28:57<40:43, 24.68s/it]
 43%|████▎     | 74/172 [29:20<39:38, 24.27s/it]
 44%|████▎     | 75/172 [29:45<39:34, 24.48s/it]
 44%|████▍     | 76/172 [30:10<39:01, 24.39s/it]
 45%|████▍     | 77/172 [30:35<39:10, 24.74s/it]
 45%|████▌     | 78/172 [31:00<38:50, 24.80s/it]
 46%|████▌     | 79/172 [31:23<37:43, 24.34s/it]
 47%|████▋     | 80/172 [31:50<38:32, 25.13s/it]
 47%|████▋     | 81/172 [32:14<37:29, 24.72s/it]
 48%|████▊     | 82/172 [32:35<35:20, 23.57s/it]
 48%|████▊     | 83/172 [33:00<35:31, 23.95s/it]
 49%|████▉     | 84/172 [33:24<35:25, 24.16s/it]
 49%|████▉     | 85/172 [33:51<36:07, 24.92s/it]
 50%|█████     | 86/172 [34:15<35:04, 24.47s/it]
 51%|█████     | 87/172 [34:40<34:54, 24.64s/it]
 51%|█████     | 88/172 [35:03<33:58, 24.27s/it]
 52%|█████▏    | 89/172 [35:27<33:21, 24.11s/it]
 52%|█████▏    | 90/172 [35:51<33:04, 24.20s/it]
 53%|█████▎    | 91/172 [36:20<34:37, 25.64s/it]
 53%|█████▎    | 92/172 [36:44<33:30, 25.13s/it]
 54%|█████▍    | 93/172 [37:06<31:41, 24.07s/it]
 55%|█████▍    | 94/172 [37:27<30:19, 23.33s/it]
 55%|█████▌    | 95/172 [37:48<28:56, 22.55s/it]
 56%|█████▌    | 96/172 [38:08<27:24, 21.64s/it]
 56%|█████▋    | 97/172 [38:35<29:03, 23.24s/it]
 57%|█████▋    | 98/172 [39:00<29:34, 23.99s/it]
 58%|█████▊    | 99/172 [39:24<28:59, 23.83s/it]
 58%|█████▊    | 100/172 [39:45<27:49, 23.19s/it]
 59%|█████▊    | 101/172 [40:08<27:13, 23.00s/it]
 59%|█████▉    | 102/172 [40:32<27:13, 23.34s/it]
 60%|█████▉    | 103/172 [40:55<26:51, 23.36s/it]
 60%|██████    | 104/172 [41:18<26:19, 23.23s/it]
 61%|██████    | 105/172 [41:45<27:07, 24.29s/it]
 62%|██████▏   | 106/172 [42:10<26:49, 24.38s/it]
 62%|██████▏   | 107/172 [42:33<26:11, 24.18s/it]
 63%|██████▎   | 108/172 [42:58<25:48, 24.19s/it]
 63%|██████▎   | 109/172 [43:23<25:50, 24.61s/it]
 64%|██████▍   | 110/172 [43:50<26:10, 25.34s/it]
 65%|██████▍   | 111/172 [44:13<24:57, 24.56s/it]
 65%|██████▌   | 112/172 [44:38<24:47, 24.79s/it]
 66%|██████▌   | 113/172 [45:04<24:29, 24.90s/it]
 66%|██████▋   | 114/172 [45:27<23:31, 24.34s/it]
 67%|██████▋   | 115/172 [45:53<23:36, 24.86s/it]
 67%|██████▋   | 116/172 [46:14<22:12, 23.80s/it]
 68%|██████▊   | 117/172 [46:38<21:57, 23.96s/it]
 69%|██████▊   | 118/172 [47:04<21:59, 24.43s/it]
 69%|██████▉   | 119/172 [47:31<22:21, 25.31s/it]
 70%|██████▉   | 120/172 [47:56<21:52, 25.24s/it]
 70%|███████   | 121/172 [48:18<20:36, 24.25s/it]
 71%|███████   | 122/172 [48:42<20:11, 24.23s/it]
 72%|███████▏  | 123/172 [49:06<19:39, 24.07s/it]
 72%|███████▏  | 124/172 [49:28<18:51, 23.57s/it]
 73%|███████▎  | 125/172 [49:54<18:56, 24.17s/it]
 73%|███████▎  | 126/172 [50:18<18:29, 24.11s/it]
 74%|███████▍  | 127/172 [50:43<18:19, 24.43s/it]
 74%|███████▍  | 128/172 [51:06<17:39, 24.07s/it]
 75%|███████▌  | 129/172 [51:30<17:08, 23.92s/it]
 76%|███████▌  | 130/172 [51:53<16:37, 23.74s/it]
 76%|███████▌  | 131/172 [52:16<16:03, 23.51s/it]
 77%|███████▋  | 132/172 [52:39<15:33, 23.33s/it]
 77%|███████▋  | 133/172 [53:02<15:04, 23.19s/it]
 78%|███████▊  | 134/172 [53:26<14:50, 23.44s/it]
 78%|███████▊  | 135/172 [53:49<14:24, 23.37s/it]
 79%|███████▉  | 136/172 [54:10<13:35, 22.65s/it]
 80%|███████▉  | 137/172 [54:37<13:51, 23.76s/it]
 80%|████████  | 138/172 [54:57<12:56, 22.84s/it]
 81%|████████  | 139/172 [55:21<12:37, 22.95s/it]
 81%|████████▏ | 140/172 [55:44<12:19, 23.11s/it]
 82%|████████▏ | 141/172 [56:06<11:42, 22.65s/it]
 83%|████████▎ | 142/172 [56:29<11:23, 22.78s/it]
 83%|████████▎ | 143/172 [56:50<10:45, 22.26s/it]
 84%|████████▎ | 144/172 [57:09<09:58, 21.38s/it]
 84%|████████▍ | 145/172 [57:32<09:50, 21.86s/it]
 85%|████████▍ | 146/172 [57:57<09:48, 22.64s/it]
 85%|████████▌ | 147/172 [58:19<09:27, 22.70s/it]
 86%|████████▌ | 148/172 [58:44<09:16, 23.19s/it]
 87%|████████▋ | 149/172 [59:08<09:02, 23.57s/it]
 87%|████████▋ | 150/172 [59:30<08:26, 23.03s/it]
 88%|████████▊ | 151/172 [59:52<07:55, 22.63s/it]
 88%|████████▊ | 152/172 [1:00:14<07:33, 22.65s/it]
 89%|████████▉ | 153/172 [1:00:36<07:04, 22.36s/it]
 90%|████████▉ | 154/172 [1:01:02<07:04, 23.61s/it]
 90%|█████████ | 155/172 [1:01:26<06:41, 23.60s/it]
 91%|█████████ | 156/172 [1:01:51<06:23, 23.95s/it]
 91%|█████████▏| 157/172 [1:02:14<05:57, 23.81s/it]
 92%|█████████▏| 158/172 [1:02:36<05:22, 23.05s/it]
 92%|█████████▏| 159/172 [1:03:00<05:03, 23.32s/it]
 93%|█████████▎| 160/172 [1:03:26<04:50, 24.19s/it]
 94%|█████████▎| 161/172 [1:03:54<04:38, 25.28s/it]
 94%|█████████▍| 162/172 [1:04:19<04:12, 25.22s/it]
 95%|█████████▍| 163/172 [1:04:45<03:50, 25.59s/it]
 95%|█████████▌| 164/172 [1:05:15<03:34, 26.77s/it]
 96%|█████████▌| 165/172 [1:05:39<03:01, 25.93s/it]
 97%|█████████▋| 166/172 [1:06:03<02:32, 25.46s/it]
 97%|█████████▋| 167/172 [1:06:26<02:04, 24.85s/it]
 98%|█████████▊| 168/172 [1:06:49<01:36, 24.03s/it]
 98%|█████████▊| 169/172 [1:07:13<01:12, 24.11s/it]
 99%|█████████▉| 170/172 [1:07:38<00:48, 24.44s/it]
 99%|█████████▉| 171/172 [1:08:00<00:23, 23.84s/it]
100%|██████████| 172/172 [1:08:05<00:00, 17.92s/it]
100%|██████████| 172/172 [1:08:05<00:00, 23.75s/it]
Total: 10955
07/08/2024 14:00:44 - INFO - __main__ -     bleu-4 = 18.79 
07/08/2024 14:00:44 - INFO - __main__ -     ********************
07/08/2024 14:00:44 - INFO - __main__ -   Average inference time: 23.72098340960436
