08/08/2024 13:15:14 - INFO - __main__ -   Namespace(model_type='roberta', model_name_or_path='microsoft/codebert-base', output_dir='model/java', load_model_path='model/java/checkpoint-best-bleu/pytorch_model.bin', train_filename=None, dev_filename=None, test_filename='../dataset/java/test.jsonl', config_name='', tokenizer_name='', max_source_length=256, max_target_length=128, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=False, quantize=False, quantize4=False, quantizef8=False, prune=True, prune4=False, prune6=False, do_retrain=False, train_batch_size=8, eval_batch_size=64, gradient_accumulation_steps=1, learning_rate=5e-05, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=3, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=0, local_rank=-1, seed=42, job_id='92572', file_len=300)
08/08/2024 13:15:14 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False
08/08/2024 13:15:19 - INFO - __main__ -   reload model from model/java/checkpoint-best-bleu/pytorch_model.bin
08/08/2024 13:15:24 - INFO - __main__ -   Apply model pruning
08/08/2024 13:15:27 - INFO - __main__ -   Size (MB): 706.91481
08/08/2024 13:15:28 - INFO - __main__ -   Test file: ../dataset/java/test.jsonl
  0%|          | 0/172 [00:00<?, ?it/s]/NFSHOME/gdaloisio/code/CodeXGLUE/Code-Text/code-to-text/code/model.py:114: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:78.)
  self.scores = self.tt.FloatTensor(size).zero_()
  1%|          | 1/172 [00:38<1:49:14, 38.33s/it]  1%|          | 2/172 [01:06<1:31:41, 32.36s/it]  2%|▏         | 3/172 [01:32<1:23:12, 29.54s/it]  2%|▏         | 4/172 [02:02<1:23:06, 29.68s/it]  3%|▎         | 5/172 [02:32<1:22:34, 29.67s/it]  3%|▎         | 6/172 [03:02<1:22:19, 29.75s/it]  4%|▍         | 7/172 [03:30<1:20:59, 29.45s/it]  5%|▍         | 8/172 [03:57<1:17:49, 28.47s/it]  5%|▌         | 9/172 [04:23<1:15:42, 27.87s/it]  6%|▌         | 10/172 [04:48<1:12:55, 27.01s/it]  6%|▋         | 11/172 [05:13<1:10:11, 26.16s/it]  7%|▋         | 12/172 [05:39<1:09:56, 26.23s/it]  8%|▊         | 13/172 [06:05<1:08:58, 26.03s/it]  8%|▊         | 14/172 [06:31<1:08:35, 26.05s/it]  9%|▊         | 15/172 [06:57<1:07:58, 25.98s/it]  9%|▉         | 16/172 [07:21<1:06:26, 25.55s/it] 10%|▉         | 17/172 [07:48<1:07:21, 26.07s/it] 10%|█         | 18/172 [08:14<1:06:47, 26.02s/it] 11%|█         | 19/172 [08:39<1:05:32, 25.70s/it] 12%|█▏        | 20/172 [09:04<1:04:29, 25.45s/it] 12%|█▏        | 21/172 [09:29<1:03:29, 25.23s/it] 13%|█▎        | 22/172 [09:53<1:02:33, 25.03s/it] 13%|█▎        | 23/172 [10:20<1:02:57, 25.35s/it] 14%|█▍        | 24/172 [10:46<1:03:24, 25.71s/it] 15%|█▍        | 25/172 [11:11<1:02:02, 25.32s/it] 15%|█▌        | 26/172 [11:36<1:02:03, 25.51s/it] 16%|█▌        | 27/172 [12:02<1:01:52, 25.60s/it] 16%|█▋        | 28/172 [12:28<1:01:37, 25.68s/it] 17%|█▋        | 29/172 [12:54<1:01:20, 25.73s/it] 17%|█▋        | 30/172 [13:20<1:00:46, 25.68s/it] 18%|█▊        | 31/172 [13:47<1:01:27, 26.15s/it] 19%|█▊        | 32/172 [14:17<1:03:31, 27.22s/it] 19%|█▉        | 33/172 [14:46<1:04:37, 27.90s/it] 20%|█▉        | 34/172 [15:12<1:03:02, 27.41s/it] 20%|██        | 35/172 [15:40<1:02:40, 27.45s/it] 21%|██        | 36/172 [16:07<1:01:55, 27.32s/it] 22%|██▏       | 37/172 [16:35<1:02:08, 27.62s/it] 22%|██▏       | 38/172 [17:01<1:00:24, 27.05s/it] 23%|██▎       | 39/172 [17:29<1:00:22, 27.24s/it] 23%|██▎       | 40/172 [17:55<59:09, 26.89s/it]   24%|██▍       | 41/172 [18:24<1:00:07, 27.54s/it] 24%|██▍       | 42/172 [18:51<59:50, 27.62s/it]   25%|██▌       | 43/172 [19:19<59:03, 27.47s/it] 26%|██▌       | 44/172 [19:44<57:14, 26.83s/it] 26%|██▌       | 45/172 [20:11<57:06, 26.98s/it] 27%|██▋       | 46/172 [20:40<57:31, 27.39s/it] 27%|██▋       | 47/172 [21:04<55:27, 26.62s/it] 28%|██▊       | 48/172 [21:30<54:21, 26.30s/it] 28%|██▊       | 49/172 [21:56<53:38, 26.16s/it] 29%|██▉       | 50/172 [22:22<53:28, 26.30s/it] 30%|██▉       | 51/172 [22:47<52:07, 25.85s/it] 30%|███       | 52/172 [23:18<54:28, 27.24s/it] 31%|███       | 53/172 [23:46<54:20, 27.40s/it] 31%|███▏      | 54/172 [24:13<54:10, 27.55s/it] 32%|███▏      | 55/172 [24:41<53:52, 27.63s/it] 33%|███▎      | 56/172 [25:09<53:26, 27.64s/it] 33%|███▎      | 57/172 [25:38<53:42, 28.02s/it] 34%|███▎      | 58/172 [26:04<52:17, 27.52s/it] 34%|███▍      | 59/172 [26:29<50:29, 26.81s/it] 35%|███▍      | 60/172 [26:54<48:45, 26.12s/it] 35%|███▌      | 61/172 [27:17<46:41, 25.24s/it] 36%|███▌      | 62/172 [27:40<44:54, 24.49s/it] 37%|███▋      | 63/172 [28:05<44:48, 24.66s/it] 37%|███▋      | 64/172 [28:32<45:40, 25.38s/it] 38%|███▊      | 65/172 [29:00<46:54, 26.31s/it] 38%|███▊      | 66/172 [29:27<46:26, 26.29s/it] 39%|███▉      | 67/172 [29:53<45:49, 26.19s/it] 40%|███▉      | 68/172 [30:21<46:43, 26.96s/it] 40%|████      | 69/172 [30:47<45:36, 26.57s/it] 41%|████      | 70/172 [31:16<46:29, 27.35s/it] 41%|████▏     | 71/172 [31:46<47:10, 28.03s/it] 42%|████▏     | 72/172 [32:12<45:50, 27.50s/it] 42%|████▏     | 73/172 [32:45<48:16, 29.26s/it] 43%|████▎     | 74/172 [33:11<46:10, 28.27s/it] 44%|████▎     | 75/172 [33:36<44:12, 27.34s/it] 44%|████▍     | 76/172 [34:03<43:09, 26.97s/it] 45%|████▍     | 77/172 [34:32<44:03, 27.83s/it] 45%|████▌     | 78/172 [34:59<43:13, 27.59s/it] 46%|████▌     | 79/172 [35:24<41:33, 26.81s/it] 47%|████▋     | 80/172 [35:52<41:16, 26.92s/it] 47%|████▋     | 81/172 [36:18<40:34, 26.75s/it] 48%|████▊     | 82/172 [36:43<39:28, 26.31s/it] 48%|████▊     | 83/172 [37:11<39:31, 26.65s/it] 49%|████▉     | 84/172 [37:39<39:57, 27.24s/it] 49%|████▉     | 85/172 [38:08<40:16, 27.78s/it] 50%|█████     | 86/172 [38:41<42:05, 29.36s/it] 51%|█████     | 87/172 [39:10<41:07, 29.03s/it] 51%|█████     | 88/172 [39:35<39:03, 27.90s/it] 52%|█████▏    | 89/172 [40:02<38:03, 27.51s/it] 52%|█████▏    | 90/172 [40:27<36:40, 26.83s/it] 53%|█████▎    | 91/172 [40:56<37:16, 27.61s/it] 53%|█████▎    | 92/172 [41:21<35:49, 26.87s/it] 54%|█████▍    | 93/172 [41:47<35:05, 26.65s/it] 55%|█████▍    | 94/172 [42:13<34:03, 26.20s/it] 55%|█████▌    | 95/172 [42:36<32:39, 25.45s/it] 56%|█████▌    | 96/172 [43:00<31:26, 24.82s/it] 56%|█████▋    | 97/172 [43:25<31:19, 25.06s/it] 57%|█████▋    | 98/172 [43:55<32:31, 26.37s/it] 58%|█████▊    | 99/172 [44:22<32:18, 26.56s/it] 58%|█████▊    | 100/172 [44:45<30:33, 25.46s/it] 59%|█████▊    | 101/172 [45:08<29:24, 24.85s/it] 59%|█████▉    | 102/172 [45:33<29:05, 24.93s/it] 60%|█████▉    | 103/172 [45:59<28:49, 25.07s/it] 60%|██████    | 104/172 [46:24<28:33, 25.20s/it] 61%|██████    | 105/172 [46:50<28:12, 25.27s/it] 62%|██████▏   | 106/172 [47:17<28:34, 25.98s/it] 62%|██████▏   | 107/172 [47:43<28:15, 26.08s/it] 63%|██████▎   | 108/172 [48:08<27:22, 25.66s/it] 63%|██████▎   | 109/172 [48:35<27:28, 26.16s/it] 64%|██████▍   | 110/172 [49:03<27:31, 26.64s/it] 65%|██████▍   | 111/172 [49:29<26:49, 26.38s/it] 65%|██████▌   | 112/172 [49:57<26:59, 26.99s/it] 66%|██████▌   | 113/172 [50:23<26:13, 26.67s/it] 66%|██████▋   | 114/172 [50:48<25:14, 26.11s/it] 67%|██████▋   | 115/172 [51:18<25:53, 27.25s/it] 67%|██████▋   | 116/172 [51:42<24:26, 26.19s/it] 68%|██████▊   | 117/172 [52:08<23:56, 26.12s/it] 69%|██████▊   | 118/172 [52:36<24:02, 26.71s/it] 69%|██████▉   | 119/172 [53:03<23:46, 26.91s/it] 70%|██████▉   | 120/172 [53:31<23:27, 27.06s/it] 70%|███████   | 121/172 [53:54<22:10, 26.09s/it] 71%|███████   | 122/172 [54:22<22:08, 26.58s/it] 72%|███████▏  | 123/172 [54:47<21:19, 26.11s/it] 72%|███████▏  | 124/172 [55:13<20:50, 26.05s/it] 73%|███████▎  | 125/172 [55:40<20:41, 26.42s/it] 73%|███████▎  | 126/172 [56:11<21:20, 27.83s/it] 74%|███████▍  | 127/172 [56:42<21:22, 28.50s/it] 74%|███████▍  | 128/172 [57:08<20:23, 27.81s/it] 75%|███████▌  | 129/172 [57:32<19:13, 26.82s/it] 76%|███████▌  | 130/172 [57:56<18:04, 25.82s/it] 76%|███████▌  | 131/172 [58:19<17:10, 25.13s/it] 77%|███████▋  | 132/172 [58:45<16:47, 25.19s/it] 77%|███████▋  | 133/172 [59:09<16:17, 25.05s/it] 78%|███████▊  | 134/172 [59:36<16:11, 25.57s/it] 78%|███████▊  | 135/172 [1:00:02<15:54, 25.81s/it] 79%|███████▉  | 136/172 [1:00:26<15:09, 25.25s/it] 80%|███████▉  | 137/172 [1:00:51<14:41, 25.19s/it] 80%|████████  | 138/172 [1:01:14<13:46, 24.32s/it] 81%|████████  | 139/172 [1:01:38<13:22, 24.32s/it] 81%|████████▏ | 140/172 [1:02:03<13:06, 24.58s/it] 82%|████████▏ | 141/172 [1:02:29<12:48, 24.80s/it] 83%|████████▎ | 142/172 [1:02:55<12:34, 25.16s/it] 83%|████████▎ | 143/172 [1:03:18<11:58, 24.76s/it] 84%|████████▎ | 144/172 [1:03:40<11:06, 23.81s/it] 84%|████████▍ | 145/172 [1:04:04<10:43, 23.84s/it] 85%|████████▍ | 146/172 [1:04:29<10:28, 24.17s/it] 85%|████████▌ | 147/172 [1:04:59<10:46, 25.86s/it] 86%|████████▌ | 148/172 [1:05:25<10:23, 25.99s/it] 87%|████████▋ | 149/172 [1:05:50<09:50, 25.70s/it] 87%|████████▋ | 150/172 [1:06:13<09:08, 24.92s/it] 88%|████████▊ | 151/172 [1:06:37<08:35, 24.57s/it] 88%|████████▊ | 152/172 [1:07:02<08:16, 24.85s/it] 89%|████████▉ | 153/172 [1:07:29<08:00, 25.27s/it] 90%|████████▉ | 154/172 [1:07:54<07:35, 25.29s/it] 90%|█████████ | 155/172 [1:08:19<07:09, 25.27s/it] 91%|█████████ | 156/172 [1:08:46<06:54, 25.88s/it] 91%|█████████▏| 157/172 [1:09:11<06:21, 25.44s/it] 92%|█████████▏| 158/172 [1:09:37<06:00, 25.72s/it] 92%|█████████▏| 159/172 [1:10:02<05:31, 25.52s/it] 93%|█████████▎| 160/172 [1:10:28<05:07, 25.65s/it] 94%|█████████▎| 161/172 [1:10:57<04:52, 26.56s/it] 94%|█████████▍| 162/172 [1:11:23<04:24, 26.49s/it] 95%|█████████▍| 163/172 [1:11:54<04:10, 27.79s/it] 95%|█████████▌| 164/172 [1:12:23<03:44, 28.02s/it] 96%|█████████▌| 165/172 [1:12:48<03:10, 27.17s/it] 97%|█████████▋| 166/172 [1:13:12<02:37, 26.31s/it] 97%|█████████▋| 167/172 [1:13:38<02:11, 26.27s/it] 98%|█████████▊| 168/172 [1:14:05<01:45, 26.32s/it] 98%|█████████▊| 169/172 [1:14:31<01:18, 26.31s/it] 99%|█████████▉| 170/172 [1:14:58<00:53, 26.51s/it] 99%|█████████▉| 171/172 [1:15:23<00:26, 26.05s/it]100%|██████████| 172/172 [1:15:28<00:00, 19.66s/it]100%|██████████| 172/172 [1:15:28<00:00, 26.33s/it]
Total: 10955
08/08/2024 14:31:22 - INFO - __main__ -     bleu-4 = 17.99 
08/08/2024 14:31:22 - INFO - __main__ -     ********************
08/08/2024 14:31:22 - INFO - __main__ -   Average inference time: 26.297952631185222
