No CUDA runtime is found, using CUDA_HOME='/usr/local/cuda'
08/07/2024 04:26:36 - INFO - __main__ -   Namespace(model_type='roberta', model_name_or_path='microsoft/codebert-base', output_dir='model/java', load_model_path='model/java/checkpoint-best-bleu/pytorch_model.bin', train_filename=None, dev_filename=None, test_filename='../dataset/java/test.jsonl', config_name='', tokenizer_name='', max_source_length=256, max_target_length=128, do_train=False, do_eval=False, do_test=True, do_lower_case=False, no_cuda=True, quantize=False, quantize4=False, quantizef8=False, prune=False, prune4=False, prune6=True, do_retrain=False, train_batch_size=8, eval_batch_size=64, gradient_accumulation_steps=1, learning_rate=5e-05, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=3, max_steps=-1, eval_steps=-1, train_steps=-1, warmup_steps=0, local_rank=-1, seed=42, job_id='73533', file_len=300)
08/07/2024 04:26:36 - WARNING - __main__ -   Process rank: -1, device: cpu, n_gpu: 2, distributed training: False
08/07/2024 04:26:41 - INFO - __main__ -   reload model from model/java/checkpoint-best-bleu/pytorch_model.bin
08/07/2024 04:26:45 - INFO - __main__ -   Apply model pruning 0.6
08/07/2024 04:26:54 - INFO - __main__ -   Size (MB): 706.910458
08/07/2024 04:26:55 - INFO - __main__ -   Test file: ../dataset/java/test.jsonl
  0%|          | 0/172 [00:00<?, ?it/s]  1%|          | 1/172 [03:27<9:52:45, 207.99s/it]  1%|          | 2/172 [13:25<20:38:24, 437.09s/it]  2%|▏         | 3/172 [23:49<24:31:51, 522.55s/it]  2%|▏         | 4/172 [30:22<21:59:46, 471.35s/it]  3%|▎         | 5/172 [44:51<28:31:29, 614.91s/it]  3%|▎         | 6/172 [54:49<28:04:31, 608.87s/it]  4%|▍         | 7/172 [59:34<23:03:10, 502.97s/it]  5%|▍         | 8/172 [1:07:09<22:13:41, 487.94s/it]  5%|▌         | 9/172 [1:14:05<21:04:03, 465.29s/it]  6%|▌         | 10/172 [1:18:05<17:48:14, 395.64s/it]  6%|▋         | 11/172 [1:25:19<18:13:08, 407.38s/it]  7%|▋         | 12/172 [1:30:47<17:01:59, 383.25s/it]  8%|▊         | 13/172 [1:38:33<18:02:14, 408.39s/it]  8%|▊         | 14/172 [1:47:44<19:48:37, 451.37s/it]  9%|▊         | 15/172 [1:52:16<17:19:47, 397.37s/it]  9%|▉         | 16/172 [2:01:35<19:20:11, 446.23s/it] 10%|▉         | 17/172 [2:11:55<21:27:12, 498.27s/it] 10%|█         | 18/172 [2:21:34<22:21:44, 522.76s/it] 11%|█         | 19/172 [2:32:38<24:00:50, 565.03s/it] 12%|█▏        | 20/172 [2:37:32<20:25:36, 483.79s/it] 12%|█▏        | 21/172 [2:44:48<19:41:03, 469.30s/it] 13%|█▎        | 22/172 [2:53:26<20:09:31, 483.81s/it] 13%|█▎        | 23/172 [3:03:38<21:37:07, 522.33s/it] 14%|█▍        | 24/172 [3:14:12<22:50:59, 555.81s/it] 15%|█▍        | 25/172 [3:23:38<22:49:16, 558.89s/it] 15%|█▌        | 26/172 [3:30:30<20:53:00, 514.93s/it] 16%|█▌        | 27/172 [3:37:09<19:20:08, 480.06s/it] 16%|█▋        | 28/172 [3:45:18<19:18:45, 482.81s/it] 17%|█▋        | 29/172 [3:58:34<22:54:19, 576.64s/it] 17%|█▋        | 30/172 [4:02:12<18:30:19, 469.15s/it] 18%|█▊        | 31/172 [4:10:13<18:30:54, 472.73s/it] 19%|█▊        | 32/172 [4:22:25<21:24:26, 550.48s/it] 19%|█▉        | 33/172 [4:32:04<21:34:50, 558.92s/it] 20%|█▉        | 34/172 [4:40:16<20:39:28, 538.90s/it] 20%|██        | 35/172 [4:49:46<20:51:59, 548.32s/it] 21%|██        | 36/172 [5:01:22<22:23:23, 592.67s/it] 22%|██▏       | 37/172 [5:11:27<22:21:28, 596.21s/it] 22%|██▏       | 38/172 [5:20:52<21:50:41, 586.87s/it] 23%|██▎       | 39/172 [5:30:32<21:36:32, 584.90s/it] 23%|██▎       | 40/172 [5:35:27<18:15:30, 497.96s/it] 24%|██▍       | 41/172 [5:43:20<17:50:44, 490.41s/it] 24%|██▍       | 42/172 [5:46:39<14:32:55, 402.89s/it] 25%|██▌       | 43/172 [5:58:25<17:41:53, 493.91s/it] 26%|██▌       | 44/172 [6:06:56<17:44:53, 499.17s/it] 26%|██▌       | 45/172 [6:16:02<18:06:07, 513.13s/it] 27%|██▋       | 46/172 [6:29:45<21:12:47, 606.09s/it] 27%|██▋       | 47/172 [6:45:12<24:23:02, 702.26s/it] 28%|██▊       | 48/172 [6:56:50<24:09:04, 701.17s/it] 28%|██▊       | 49/172 [7:08:57<24:13:05, 708.83s/it] 29%|██▉       | 50/172 [7:22:32<25:05:45, 740.54s/it] 30%|██▉       | 51/172 [7:31:55<23:06:11, 687.37s/it] 30%|███       | 52/172 [7:43:37<23:03:44, 691.87s/it] 31%|███       | 53/172 [8:09:58<31:40:55, 958.45s/it] 31%|███▏      | 54/172 [8:40:33<40:02:08, 1221.42s/it] 32%|███▏      | 55/172 [8:51:55<34:26:09, 1059.57s/it] 33%|███▎      | 56/172 [8:59:34<28:20:23, 879.51s/it]  33%|███▎      | 57/172 [9:23:59<33:42:05, 1055.00s/it] 34%|███▎      | 58/172 [10:04:32<46:30:22, 1468.62s/it] 34%|███▍      | 59/172 [10:46:26<55:56:10, 1782.04s/it] 35%|███▍      | 60/172 [11:30:51<63:40:59, 2046.96s/it] 35%|███▌      | 61/172 [12:13:10<67:40:17, 2194.76s/it] 36%|███▌      | 62/172 [13:04:49<75:20:55, 2465.96s/it] 37%|███▋      | 63/172 [13:40:49<71:53:07, 2374.19s/it] 37%|███▋      | 64/172 [13:56:10<58:08:27, 1938.04s/it] 38%|███▊      | 65/172 [14:00:47<42:47:36, 1439.78s/it] 38%|███▊      | 66/172 [14:07:32<33:15:08, 1129.32s/it] 39%|███▉      | 67/172 [14:12:48<25:49:21, 885.34s/it]  40%|███▉      | 68/172 [14:22:13<22:48:05, 789.28s/it] 40%|████      | 69/172 [14:27:39<18:36:22, 650.32s/it] 41%|████      | 70/172 [14:34:17<16:16:44, 574.55s/it] 41%|████▏     | 71/172 [14:39:54<14:07:18, 503.35s/it] 42%|████▏     | 72/172 [14:44:49<12:14:55, 440.95s/it] 42%|████▏     | 73/172 [14:49:59<11:02:49, 401.71s/it] 43%|████▎     | 74/172 [14:58:43<11:56:05, 438.42s/it] 44%|████▎     | 75/172 [15:05:50<11:42:47, 434.72s/it] 44%|████▍     | 76/172 [15:14:34<12:18:26, 461.53s/it] 45%|████▍     | 77/172 [15:22:32<12:18:37, 466.50s/it] 45%|████▌     | 78/172 [15:28:18<11:14:22, 430.46s/it] 46%|████▌     | 79/172 [15:36:46<11:43:26, 453.84s/it] 47%|████▋     | 80/172 [15:47:42<13:08:53, 514.49s/it] 47%|████▋     | 81/172 [15:54:58<12:24:33, 490.92s/it] 48%|████▊     | 82/172 [16:02:56<12:10:28, 486.99s/it] 48%|████▊     | 83/172 [16:10:11<11:39:11, 471.36s/it] 49%|████▉     | 84/172 [16:18:50<11:52:20, 485.69s/it] 49%|████▉     | 85/172 [16:27:54<12:09:35, 503.17s/it] 50%|█████     | 86/172 [16:34:24<11:12:16, 469.03s/it] 51%|█████     | 87/172 [16:43:04<11:26:10, 484.36s/it] 51%|█████     | 88/172 [16:48:16<10:05:47, 432.70s/it] 52%|█████▏    | 89/172 [16:53:21<9:05:32, 394.37s/it]  52%|█████▏    | 90/172 [16:59:55<8:59:02, 394.42s/it] 53%|█████▎    | 91/172 [17:05:38<8:31:26, 378.85s/it] 53%|█████▎    | 92/172 [17:11:54<8:23:59, 377.99s/it] 54%|█████▍    | 93/172 [17:27:13<11:51:21, 540.27s/it] 55%|█████▍    | 94/172 [17:43:24<14:30:17, 669.45s/it] 55%|█████▌    | 95/172 [18:01:07<16:50:46, 787.61s/it] 56%|█████▌    | 96/172 [18:14:44<16:48:47, 796.41s/it] 56%|█████▋    | 97/172 [18:24:02<15:06:17, 725.04s/it] 57%|█████▋    | 98/172 [18:32:46<13:39:39, 664.59s/it] 58%|█████▊    | 99/172 [18:40:34<12:17:00, 605.76s/it] 58%|█████▊    | 100/172 [18:49:41<11:45:34, 587.97s/it] 59%|█████▊    | 101/172 [18:57:53<11:01:46, 559.24s/it] 59%|█████▉    | 102/172 [19:03:20<9:31:15, 489.65s/it]  60%|█████▉    | 103/172 [19:12:47<9:49:30, 512.62s/it] 60%|██████    | 104/172 [19:19:48<9:10:00, 485.31s/it] 61%|██████    | 105/172 [19:29:21<9:31:23, 511.70s/it] 62%|██████▏   | 106/172 [19:36:49<9:01:50, 492.59s/it] 62%|██████▏   | 107/172 [19:46:22<9:19:39, 516.61s/it] 63%|██████▎   | 108/172 [19:55:24<9:19:03, 524.12s/it] 63%|██████▎   | 109/172 [20:01:17<8:16:30, 472.86s/it] 64%|██████▍   | 110/172 [20:04:28<6:41:16, 388.33s/it] 65%|██████▍   | 111/172 [20:11:17<6:41:11, 394.61s/it] 65%|██████▌   | 112/172 [20:16:49<6:15:51, 375.85s/it] 66%|██████▌   | 113/172 [20:24:53<6:41:29, 408.29s/it] 66%|██████▋   | 114/172 [20:33:38<7:08:21, 443.13s/it] 67%|██████▋   | 115/172 [20:39:57<6:42:51, 424.06s/it] 67%|██████▋   | 116/172 [20:46:12<6:21:58, 409.26s/it] 68%|██████▊   | 117/172 [20:50:12<5:28:30, 358.37s/it] 69%|██████▊   | 118/172 [20:57:24<5:42:31, 380.58s/it] 69%|██████▉   | 119/172 [21:07:09<6:30:18, 441.86s/it] 70%|██████▉   | 120/172 [21:14:07<6:16:50, 434.82s/it] 70%|███████   | 121/172 [21:19:34<5:42:07, 402.50s/it] 71%|███████   | 122/172 [21:25:23<5:22:02, 386.45s/it] 72%|███████▏  | 123/172 [21:30:52<5:01:19, 368.96s/it] 72%|███████▏  | 124/172 [21:38:43<5:19:45, 399.70s/it] 73%|███████▎  | 125/172 [21:45:41<5:17:28, 405.29s/it] 73%|███████▎  | 126/172 [21:53:49<5:29:38, 429.97s/it] 74%|███████▍  | 127/172 [21:59:21<5:00:29, 400.66s/it] 74%|███████▍  | 128/172 [22:07:19<5:10:43, 423.71s/it] 75%|███████▌  | 129/172 [22:16:51<5:35:42, 468.43s/it] 76%|███████▌  | 130/172 [22:26:29<5:50:48, 501.14s/it] 76%|███████▌  | 131/172 [22:34:55<5:43:30, 502.69s/it] 77%|███████▋  | 132/172 [22:42:53<5:30:08, 495.21s/it] 77%|███████▋  | 133/172 [22:53:10<5:45:43, 531.89s/it] 78%|███████▊  | 134/172 [23:06:21<6:26:04, 609.60s/it] 78%|███████▊  | 135/172 [23:24:39<7:46:13, 756.05s/it] 79%|███████▉  | 136/172 [23:42:37<8:31:35, 852.64s/it] 80%|███████▉  | 137/172 [24:00:34<8:56:38, 919.96s/it] 80%|████████  | 138/172 [24:11:51<8:00:01, 847.11s/it] 81%|████████  | 139/172 [24:16:36<6:13:01, 678.22s/it] 81%|████████▏ | 140/172 [24:23:28<5:19:07, 598.37s/it] 82%|████████▏ | 141/172 [24:33:00<5:05:06, 590.52s/it] 83%|████████▎ | 142/172 [24:42:34<4:52:44, 585.50s/it] 83%|████████▎ | 143/172 [24:55:44<5:12:39, 646.87s/it] 84%|████████▎ | 144/172 [25:01:12<4:17:13, 551.21s/it] 84%|████████▍ | 145/172 [25:08:44<3:54:41, 521.52s/it] 85%|████████▍ | 146/172 [25:13:44<3:17:15, 455.20s/it] 85%|████████▌ | 147/172 [25:21:27<3:10:35, 457.43s/it] 86%|████████▌ | 148/172 [25:27:45<2:53:23, 433.48s/it] 87%|████████▋ | 149/172 [25:34:09<2:40:34, 418.91s/it] 87%|████████▋ | 150/172 [25:37:30<2:09:36, 353.47s/it] 88%|████████▊ | 151/172 [25:44:09<2:08:27, 367.00s/it] 88%|████████▊ | 152/172 [25:50:18<2:02:35, 367.76s/it] 89%|████████▉ | 153/172 [25:58:18<2:07:03, 401.21s/it] 90%|████████▉ | 154/172 [26:06:18<2:07:27, 424.85s/it] 90%|█████████ | 155/172 [26:13:26<2:00:42, 426.04s/it] 91%|█████████ | 156/172 [26:18:29<1:43:45, 389.09s/it] 91%|█████████▏| 157/172 [26:26:34<1:44:27, 417.81s/it] 92%|█████████▏| 158/172 [26:31:38<1:29:30, 383.59s/it] 92%|█████████▏| 159/172 [26:43:44<1:45:21, 486.24s/it] 93%|█████████▎| 160/172 [26:55:30<1:50:27, 552.31s/it] 94%|█████████▎| 161/172 [27:09:50<1:58:08, 644.45s/it] 94%|█████████▍| 162/172 [27:23:55<1:57:26, 704.61s/it] 95%|█████████▍| 163/172 [27:34:16<1:41:56, 679.65s/it] 95%|█████████▌| 164/172 [27:44:29<1:27:58, 659.76s/it] 96%|█████████▌| 165/172 [27:51:27<1:08:29, 587.13s/it] 97%|█████████▋| 166/172 [27:58:50<54:23, 543.91s/it]   97%|█████████▋| 167/172 [28:05:58<42:25, 509.13s/it] 98%|█████████▊| 168/172 [28:12:50<31:59, 479.90s/it] 98%|█████████▊| 169/172 [28:17:55<21:22, 427.63s/it] 99%|█████████▉| 170/172 [28:24:48<14:06, 423.09s/it] 99%|█████████▉| 171/172 [28:31:37<06:58, 418.80s/it]100%|██████████| 172/172 [28:34:12<00:00, 339.64s/it]100%|██████████| 172/172 [28:34:12<00:00, 597.98s/it]
Total: 10955
08/08/2024 09:01:22 - INFO - __main__ -     bleu-4 = 1.25 
08/08/2024 09:01:22 - INFO - __main__ -     ********************
08/08/2024 09:01:22 - INFO - __main__ -   Average inference time: 597.9487530963365
