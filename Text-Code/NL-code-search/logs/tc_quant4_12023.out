07/12/2024 13:42:34 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
07/12/2024 13:42:36 - INFO - __main__ -   Training/evaluation parameters Namespace(train_data_file='../dataset/train.jsonl', output_dir='./saved_models', eval_data_file='../dataset/valid.jsonl', test_data_file='../dataset/test.jsonl', model_type='roberta', model_name_or_path='microsoft/codebert-base', mlm=False, mlm_probability=0.15, config_name='microsoft/codebert-base', tokenizer_name='roberta-base', cache_dir='', block_size=256, do_train=False, do_eval=True, do_test=True, evaluate_during_training=True, do_lower_case=False, train_batch_size=32, eval_batch_size=64, gradient_accumulation_steps=1, learning_rate=5e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=1.0, max_steps=-1, warmup_steps=0, logging_steps=50, save_steps=50, save_total_limit=None, eval_all_checkpoints=False, no_cuda=False, overwrite_output_dir=False, overwrite_cache=False, seed=123456, epoch=2, fp16=False, fp16_opt_level='O1', local_rank=-1, server_ip='', server_port='', quantize=False, quantize4=True, prune=False, job_id='12023', n_gpu=1, device=device(type='cuda'), per_gpu_train_batch_size=32, per_gpu_eval_batch_size=64, start_epoch=0, start_step=0)
07/12/2024 13:42:38 - INFO - __main__ -   ************ Apply Quantization qint4 *****************
07/12/2024 13:42:38 - INFO - __main__ -   ********** Calibrate **********
/NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/utils/cpp_extension.py:1967: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
07/12/2024 13:57:16 - INFO - __main__ -   Size (MB): 202.82322
07/12/2024 13:57:26 - INFO - __main__ -   ***** Running evaluation *****
07/12/2024 13:57:26 - INFO - __main__ -     Num examples = 9604
07/12/2024 13:57:26 - INFO - __main__ -     Batch size = 64
07/12/2024 14:04:48 - INFO - __main__ -   ***** Eval results *****
07/12/2024 14:04:48 - INFO - __main__ -     eval_loss = 1.2328
07/12/2024 14:04:48 - INFO - __main__ -     eval_mrr = 0.3682
07/12/2024 14:05:03 - INFO - __main__ -   ***** Running Test *****
07/12/2024 14:05:03 - INFO - __main__ -     Num examples = 19210
07/12/2024 14:05:03 - INFO - __main__ -     Batch size = 64
07/12/2024 14:19:21 - INFO - __main__ -   Average inference time: 0.03171536296705075
