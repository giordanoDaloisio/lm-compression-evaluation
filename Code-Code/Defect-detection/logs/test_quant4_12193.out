07/15/2024 15:52:26 - WARNING - __main__ -   Process rank: -1, device: cpu, n_gpu: 1, distributed training: False, 16-bits training: False
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at microsoft/codebert-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
07/15/2024 15:52:41 - INFO - __main__ -   Training/evaluation parameters Namespace(train_data_file='../dataset/train.jsonl', output_dir='./saved_models', eval_data_file='../dataset/valid.jsonl', test_data_file='../dataset/test.jsonl', model_type='roberta', model_name_or_path='microsoft/codebert-base', model=None, mlm=False, mlm_probability=0.15, config_name='', tokenizer_name='microsoft/codebert-base', cache_dir='', block_size=400, do_train=False, do_eval=True, do_test=True, evaluate_during_training=True, do_lower_case=False, train_batch_size=32, eval_batch_size=64, gradient_accumulation_steps=1, learning_rate=2e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=1.0, max_steps=-1, warmup_steps=0, logging_steps=50, save_steps=50, save_total_limit=None, eval_all_checkpoints=False, no_cuda=True, overwrite_output_dir=False, overwrite_cache=False, seed=123456, epoch=5, fp16=False, fp16_opt_level='O1', local_rank=-1, server_ip='', server_port='', early_stopping_patience=None, min_loss_delta=0.001, dropout_probability=0, job_id='12193', quantize_dynamic=False, quantize_static=False, quantize=False, quantize4=True, quantizef8=False, prune_local=False, prune6=False, prune4=False, prune=False, n_gpu=1, per_gpu_train_batch_size=32, per_gpu_eval_batch_size=64, device=device(type='cpu'), start_epoch=0, start_step=0)
07/15/2024 15:52:52 - INFO - __main__ -   ********** Apply Quantization qint4 **********
07/15/2024 15:52:56 - INFO - __main__ -   *********** Calibrate **************
  0%|          | 0/43 [00:00<?, ?it/s]/NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/optimum/quanto/library/ops.py:66: UserWarning: An exception was raised while calling the optimized kernel for quanto::unpack: Error building extension 'quanto_cpp': [1/3] c++ -MMD -MF pybind_module.o.d -DTORCH_EXTENSION_NAME=quanto_cpp -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/api/include -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/TH -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/THC -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/include/python3.9 -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++17 -O3 -c /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/optimum/quanto/library/ext/cpp/pybind_module.cpp -o pybind_module.o 
FAILED: pybind_module.o 
c++ -MMD -MF pybind_module.o.d -DTORCH_EXTENSION_NAME=quanto_cpp -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/api/include -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/TH -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/THC -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/include/python3.9 -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++17 -O3 -c /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/optimum/quanto/library/ext/cpp/pybind_module.cpp -o pybind_module.o 
In file included from /opt/ohpc/pub/compiler/gcc/12.3.0/include/c++/12.3.0/x86_64-pc-linux-gnu/bits/c++config.h:655,
                 from /opt/ohpc/pub/compiler/gcc/12.3.0/include/c++/12.3.0/cstddef:49,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/c10/core/DeviceType.h:10,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/c10/core/Device.h:3,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:11,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/ATen/core/Tensor.h:3,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/ATen/Tensor.h:3,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/extension.h:5,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/optimum/quanto/library/ext/cpp/pybind_module.cpp:15:
/opt/ohpc/pub/compiler/gcc/12.3.0/include/c++/12.3.0/x86_64-pc-linux-gnu/bits/os_defines.h:39:10: fatal error: features.h: No such file or directory
   39 | #include <features.h>
      |          ^~~~~~~~~~~~
compilation terminated.
[2/3] c++ -MMD -MF unpack.o.d -DTORCH_EXTENSION_NAME=quanto_cpp -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/api/include -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/TH -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/THC -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/include/python3.9 -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++17 -O3 -c /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/optimum/quanto/library/ext/cpp/unpack.cpp -o unpack.o 
FAILED: unpack.o 
c++ -MMD -MF unpack.o.d -DTORCH_EXTENSION_NAME=quanto_cpp -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/api/include -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/TH -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/THC -isystem /NFSHOME/gdaloisio/miniconda3/envs/codex/include/python3.9 -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++17 -O3 -c /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/optimum/quanto/library/ext/cpp/unpack.cpp -o unpack.o 
In file included from /opt/ohpc/pub/compiler/gcc/12.3.0/include/c++/12.3.0/x86_64-pc-linux-gnu/bits/c++config.h:655,
                 from /opt/ohpc/pub/compiler/gcc/12.3.0/include/c++/12.3.0/cstddef:49,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/c10/core/DeviceType.h:10,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/c10/core/Device.h:3,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/ATen/core/TensorBody.h:11,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/ATen/core/Tensor.h:3,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/ATen/Tensor.h:3,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/autograd/function_hook.h:3,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/autograd/cpp_hook.h:2,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/autograd/variable.h:6,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/autograd/autograd.h:3,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/api/include/torch/autograd.h:3,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/csrc/api/include/torch/all.h:7,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/torch/include/torch/extension.h:5,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/optimum/quanto/library/ext/cpp/unpack.h:15,
                 from /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/optimum/quanto/library/ext/cpp/unpack.cpp:15:
/opt/ohpc/pub/compiler/gcc/12.3.0/include/c++/12.3.0/x86_64-pc-linux-gnu/bits/os_defines.h:39:10: fatal error: features.h: No such file or directory
   39 | #include <features.h>
      |          ^~~~~~~~~~~~
compilation terminated.
ninja: build stopped: subcommand failed.
 Falling back to default implementation.
  warnings.warn(message + " Falling back to default implementation.")
/NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/optimum/quanto/library/ops.py:66: UserWarning: An exception was raised while calling the optimized kernel for quanto::unpack: /NFSHOME/gdaloisio/miniconda3/envs/codex/lib/python3.9/site-packages/optimum/quanto/library/ext/cpp/build/quanto_cpp.so: cannot open shared object file: No such file or directory Falling back to default implementation.
  warnings.warn(message + " Falling back to default implementation.")
  2%|▏         | 1/43 [06:11<4:20:23, 371.98s/it]  5%|▍         | 2/43 [07:44<2:21:49, 207.55s/it]  7%|▋         | 3/43 [09:17<1:43:26, 155.16s/it]  9%|▉         | 4/43 [10:54<1:25:54, 132.18s/it] 12%|█▏        | 5/43 [12:32<1:15:56, 119.90s/it] 14%|█▍        | 6/43 [14:04<1:08:13, 110.63s/it] 16%|█▋        | 7/43 [15:35<1:02:29, 104.16s/it] 19%|█▊        | 8/43 [17:08<58:41, 100.62s/it]   21%|██        | 9/43 [18:40<55:28, 97.89s/it]  23%|██▎       | 10/43 [20:11<52:38, 95.72s/it] 26%|██▌       | 11/43 [21:46<50:53, 95.41s/it] 28%|██▊       | 12/43 [23:19<48:54, 94.66s/it] 30%|███       | 13/43 [24:51<47:00, 94.01s/it] 33%|███▎      | 14/43 [26:25<45:26, 94.01s/it] 35%|███▍      | 15/43 [27:57<43:36, 93.44s/it] 37%|███▋      | 16/43 [29:29<41:50, 92.98s/it] 40%|███▉      | 17/43 [31:05<40:40, 93.86s/it] 42%|████▏     | 18/43 [32:34<38:31, 92.47s/it] 44%|████▍     | 19/43 [34:07<37:00, 92.51s/it] 47%|████▋     | 20/43 [35:38<35:19, 92.15s/it] 49%|████▉     | 21/43 [36:49<31:28, 85.84s/it] 51%|█████     | 22/43 [37:43<26:40, 76.20s/it] 53%|█████▎    | 23/43 [39:18<27:13, 81.66s/it] 56%|█████▌    | 24/43 [40:40<25:53, 81.75s/it] 58%|█████▊    | 25/43 [41:25<21:14, 70.83s/it] 60%|██████    | 26/43 [42:48<21:05, 74.45s/it] 63%|██████▎   | 27/43 [44:19<21:10, 79.41s/it] 65%|██████▌   | 28/43 [44:36<15:11, 60.80s/it] 67%|██████▋   | 29/43 [44:50<10:55, 46.81s/it] 70%|██████▉   | 30/43 [45:04<07:57, 36.73s/it] 72%|███████▏  | 31/43 [45:20<06:07, 30.63s/it] 74%|███████▍  | 32/43 [45:33<04:39, 25.39s/it] 77%|███████▋  | 33/43 [45:47<03:39, 21.93s/it] 79%|███████▉  | 34/43 [46:36<04:30, 30.03s/it] 81%|████████▏ | 35/43 [47:53<05:53, 44.16s/it] 84%|████████▎ | 36/43 [49:08<06:12, 53.27s/it] 86%|████████▌ | 37/43 [50:26<06:05, 60.95s/it] 88%|████████▊ | 38/43 [51:58<05:50, 70.12s/it] 91%|█████████ | 39/43 [53:04<04:36, 69.04s/it] 93%|█████████▎| 40/43 [54:25<03:37, 72.47s/it] 95%|█████████▌| 41/43 [55:51<02:32, 76.43s/it] 98%|█████████▊| 42/43 [56:44<01:09, 69.46s/it]100%|██████████| 43/43 [57:48<00:00, 67.94s/it]100%|██████████| 43/43 [57:48<00:00, 80.67s/it]
07/15/2024 16:51:21 - INFO - __main__ -   Size (MB): 202.830864
07/15/2024 16:51:30 - INFO - __main__ -   ***** Running evaluation *****
07/15/2024 16:51:30 - INFO - __main__ -     Num examples = 2732
07/15/2024 16:51:30 - INFO - __main__ -     Batch size = 64
07/15/2024 17:19:46 - INFO - __main__ -   Average time: 39.379023934519566
07/15/2024 17:19:47 - INFO - __main__ -   ***** Eval results *****
07/15/2024 17:19:47 - INFO - __main__ -     eval_acc = 0.6402
07/15/2024 17:19:47 - INFO - __main__ -     eval_loss = 0.6813
07/15/2024 17:19:53 - INFO - __main__ -   ***** Running Test *****
07/15/2024 17:19:53 - INFO - __main__ -     Num examples = 2732
07/15/2024 17:19:53 - INFO - __main__ -     Batch size = 64
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:25<18:02, 25.78s/it]  5%|▍         | 2/43 [00:59<20:43, 30.33s/it]  7%|▋         | 3/43 [01:48<25:57, 38.93s/it]  9%|▉         | 4/43 [02:32<26:44, 41.14s/it] 12%|█▏        | 5/43 [03:15<26:17, 41.52s/it] 14%|█▍        | 6/43 [04:13<29:10, 47.32s/it] 16%|█▋        | 7/43 [04:59<28:00, 46.68s/it] 19%|█▊        | 8/43 [05:42<26:35, 45.60s/it] 21%|██        | 9/43 [06:24<25:15, 44.57s/it] 23%|██▎       | 10/43 [07:29<27:53, 50.70s/it] 26%|██▌       | 11/43 [08:12<25:53, 48.55s/it] 28%|██▊       | 12/43 [08:52<23:42, 45.90s/it] 30%|███       | 13/43 [09:29<21:35, 43.19s/it] 33%|███▎      | 14/43 [10:24<22:35, 46.73s/it] 35%|███▍      | 15/43 [11:13<22:05, 47.34s/it] 37%|███▋      | 16/43 [11:56<20:43, 46.06s/it] 40%|███▉      | 17/43 [12:42<19:56, 46.04s/it] 42%|████▏     | 18/43 [13:42<20:59, 50.38s/it] 44%|████▍     | 19/43 [14:29<19:45, 49.40s/it] 47%|████▋     | 20/43 [15:22<19:14, 50.21s/it] 49%|████▉     | 21/43 [16:13<18:32, 50.55s/it] 51%|█████     | 22/43 [16:56<16:52, 48.23s/it] 53%|█████▎    | 23/43 [17:21<13:49, 41.47s/it] 56%|█████▌    | 24/43 [18:01<12:58, 40.96s/it] 58%|█████▊    | 25/43 [18:51<13:02, 43.49s/it] 60%|██████    | 26/43 [19:19<11:02, 38.95s/it] 63%|██████▎   | 27/43 [19:35<08:31, 31.97s/it] 65%|██████▌   | 28/43 [19:47<06:31, 26.08s/it] 67%|██████▋   | 29/43 [20:00<05:09, 22.11s/it] 70%|██████▉   | 30/43 [20:12<04:10, 19.25s/it] 72%|███████▏  | 31/43 [20:25<03:28, 17.39s/it] 74%|███████▍  | 32/43 [20:38<02:54, 15.90s/it] 77%|███████▋  | 33/43 [21:05<03:13, 19.31s/it] 79%|███████▉  | 34/43 [21:40<03:36, 24.02s/it] 81%|████████▏ | 35/43 [21:54<02:48, 21.05s/it] 84%|████████▎ | 36/43 [22:08<02:12, 18.95s/it] 86%|████████▌ | 37/43 [22:19<01:39, 16.59s/it] 88%|████████▊ | 38/43 [22:30<01:14, 14.87s/it] 91%|█████████ | 39/43 [22:44<00:57, 14.47s/it] 93%|█████████▎| 40/43 [23:24<01:06, 22.28s/it] 95%|█████████▌| 41/43 [24:10<00:58, 29.18s/it] 98%|█████████▊| 42/43 [25:05<00:36, 36.94s/it]100%|██████████| 43/43 [25:49<00:00, 39.04s/it]100%|██████████| 43/43 [25:49<00:00, 36.02s/it]
07/15/2024 17:45:42 - INFO - __main__ -   Average inference time: 35.97946779118028
