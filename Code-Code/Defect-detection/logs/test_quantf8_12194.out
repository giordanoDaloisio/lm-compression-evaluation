07/15/2024 16:39:42 - WARNING - __main__ -   Process rank: -1, device: cpu, n_gpu: 1, distributed training: False, 16-bits training: False
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at microsoft/codebert-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
07/15/2024 16:39:47 - INFO - __main__ -   Training/evaluation parameters Namespace(train_data_file='../dataset/train.jsonl', output_dir='./saved_models', eval_data_file='../dataset/valid.jsonl', test_data_file='../dataset/test.jsonl', model_type='roberta', model_name_or_path='microsoft/codebert-base', model=None, mlm=False, mlm_probability=0.15, config_name='', tokenizer_name='microsoft/codebert-base', cache_dir='', block_size=400, do_train=False, do_eval=True, do_test=True, evaluate_during_training=True, do_lower_case=False, train_batch_size=32, eval_batch_size=64, gradient_accumulation_steps=1, learning_rate=2e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=1.0, max_steps=-1, warmup_steps=0, logging_steps=50, save_steps=50, save_total_limit=None, eval_all_checkpoints=False, no_cuda=True, overwrite_output_dir=False, overwrite_cache=False, seed=123456, epoch=5, fp16=False, fp16_opt_level='O1', local_rank=-1, server_ip='', server_port='', early_stopping_patience=None, min_loss_delta=0.001, dropout_probability=0, job_id='12194', quantize_dynamic=False, quantize_static=False, quantize=False, quantize4=False, quantizef8=True, prune_local=False, prune6=False, prune4=False, prune=False, n_gpu=1, per_gpu_train_batch_size=32, per_gpu_eval_batch_size=64, device=device(type='cpu'), start_epoch=0, start_step=0)
07/15/2024 16:39:51 - INFO - __main__ -   ********** Apply Quantization qfloat8 **********
07/15/2024 16:39:55 - INFO - __main__ -   *********** Calibrate **************
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [02:57<2:04:35, 177.99s/it]  5%|▍         | 2/43 [03:43<1:08:22, 100.05s/it]  7%|▋         | 3/43 [04:32<51:02, 76.56s/it]     9%|▉         | 4/43 [05:14<40:58, 63.04s/it] 12%|█▏        | 5/43 [05:47<33:02, 52.18s/it] 14%|█▍        | 6/43 [06:19<28:03, 45.49s/it] 16%|█▋        | 7/43 [07:01<26:34, 44.28s/it] 19%|█▊        | 8/43 [07:51<26:50, 46.02s/it] 21%|██        | 9/43 [08:39<26:22, 46.55s/it] 23%|██▎       | 10/43 [09:13<23:30, 42.75s/it] 26%|██▌       | 11/43 [09:38<19:56, 37.40s/it] 28%|██▊       | 12/43 [10:07<17:59, 34.83s/it] 30%|███       | 13/43 [10:48<18:21, 36.73s/it] 33%|███▎      | 14/43 [11:21<17:11, 35.55s/it] 35%|███▍      | 15/43 [11:49<15:28, 33.15s/it] 37%|███▋      | 16/43 [12:16<14:08, 31.43s/it] 40%|███▉      | 17/43 [12:39<12:28, 28.80s/it] 42%|████▏     | 18/43 [13:02<11:20, 27.22s/it] 44%|████▍     | 19/43 [13:42<12:26, 31.12s/it] 47%|████▋     | 20/43 [14:26<13:20, 34.80s/it] 49%|████▉     | 21/43 [14:59<12:37, 34.45s/it] 51%|█████     | 22/43 [15:25<11:05, 31.68s/it] 53%|█████▎    | 23/43 [15:50<09:54, 29.73s/it] 56%|█████▌    | 24/43 [16:08<08:20, 26.35s/it] 58%|█████▊    | 25/43 [16:25<07:01, 23.44s/it] 60%|██████    | 26/43 [17:02<07:48, 27.54s/it] 63%|██████▎   | 27/43 [17:34<07:43, 28.95s/it] 65%|██████▌   | 28/43 [17:55<06:37, 26.51s/it] 67%|██████▋   | 29/43 [18:32<06:56, 29.72s/it] 70%|██████▉   | 30/43 [19:08<06:50, 31.58s/it] 72%|███████▏  | 31/43 [19:34<05:59, 29.97s/it] 74%|███████▍  | 32/43 [20:09<05:45, 31.42s/it] 77%|███████▋  | 33/43 [20:34<04:53, 29.39s/it] 79%|███████▉  | 34/43 [20:57<04:08, 27.61s/it] 81%|████████▏ | 35/43 [21:43<04:23, 32.98s/it] 84%|████████▎ | 36/43 [22:30<04:20, 37.20s/it] 86%|████████▌ | 37/43 [23:03<03:36, 36.01s/it] 88%|████████▊ | 38/43 [23:26<02:40, 32.15s/it] 91%|█████████ | 39/43 [23:52<02:00, 30.23s/it] 93%|█████████▎| 40/43 [24:28<01:35, 31.91s/it] 95%|█████████▌| 41/43 [25:04<01:06, 33.16s/it] 98%|█████████▊| 42/43 [25:46<00:35, 35.86s/it]100%|██████████| 43/43 [26:16<00:00, 33.93s/it]100%|██████████| 43/43 [26:16<00:00, 36.65s/it]
07/15/2024 17:06:23 - INFO - __main__ -   Size (MB): 242.538956
07/15/2024 17:06:30 - INFO - __main__ -   ***** Running evaluation *****
07/15/2024 17:06:30 - INFO - __main__ -     Num examples = 2732
07/15/2024 17:06:30 - INFO - __main__ -     Batch size = 64
07/15/2024 17:20:47 - INFO - __main__ -   Average time: 19.855220794677734
07/15/2024 17:20:47 - INFO - __main__ -   ***** Eval results *****
07/15/2024 17:20:47 - INFO - __main__ -     eval_acc = 0.6534
07/15/2024 17:20:47 - INFO - __main__ -     eval_loss = 0.7392
07/15/2024 17:20:54 - INFO - __main__ -   ***** Running Test *****
07/15/2024 17:20:54 - INFO - __main__ -     Num examples = 2732
07/15/2024 17:20:54 - INFO - __main__ -     Batch size = 64
  0%|          | 0/43 [00:00<?, ?it/s]  2%|▏         | 1/43 [00:29<20:39, 29.51s/it]  5%|▍         | 2/43 [00:54<18:32, 27.14s/it]  7%|▋         | 3/43 [01:20<17:31, 26.29s/it]  9%|▉         | 4/43 [01:43<16:12, 24.93s/it] 12%|█▏        | 5/43 [02:07<15:33, 24.56s/it] 14%|█▍        | 6/43 [02:39<16:43, 27.13s/it] 16%|█▋        | 7/43 [03:14<17:53, 29.83s/it] 19%|█▊        | 8/43 [03:38<16:20, 28.00s/it] 21%|██        | 9/43 [04:04<15:33, 27.46s/it] 23%|██▎       | 10/43 [04:28<14:31, 26.41s/it] 26%|██▌       | 11/43 [04:51<13:30, 25.33s/it] 28%|██▊       | 12/43 [05:15<12:49, 24.82s/it] 30%|███       | 13/43 [05:51<14:02, 28.07s/it] 33%|███▎      | 14/43 [06:27<14:46, 30.56s/it] 35%|███▍      | 15/43 [06:52<13:26, 28.80s/it] 37%|███▋      | 16/43 [07:18<12:40, 28.15s/it] 40%|███▉      | 17/43 [07:43<11:43, 27.05s/it] 42%|████▏     | 18/43 [07:56<09:33, 22.94s/it] 44%|████▍     | 19/43 [08:16<08:51, 22.16s/it] 47%|████▋     | 20/43 [08:40<08:36, 22.45s/it] 49%|████▉     | 21/43 [09:17<09:56, 27.10s/it] 51%|█████     | 22/43 [09:48<09:50, 28.10s/it] 53%|█████▎    | 23/43 [10:14<09:06, 27.35s/it] 56%|█████▌    | 24/43 [10:38<08:21, 26.39s/it] 58%|█████▊    | 25/43 [11:01<07:36, 25.39s/it] 60%|██████    | 26/43 [11:25<07:03, 24.92s/it] 63%|██████▎   | 27/43 [12:02<07:39, 28.75s/it] 65%|██████▌   | 28/43 [12:36<07:31, 30.12s/it] 67%|██████▋   | 29/43 [13:01<06:42, 28.76s/it] 70%|██████▉   | 30/43 [13:27<06:00, 27.75s/it] 72%|███████▏  | 31/43 [13:52<05:23, 26.95s/it] 74%|███████▍  | 32/43 [14:26<05:21, 29.27s/it] 77%|███████▋  | 33/43 [14:58<05:01, 30.10s/it] 79%|███████▉  | 34/43 [15:24<04:19, 28.84s/it] 81%|████████▏ | 35/43 [15:47<03:37, 27.15s/it] 84%|████████▎ | 36/43 [16:00<02:38, 22.71s/it] 86%|████████▌ | 37/43 [16:14<02:01, 20.26s/it] 88%|████████▊ | 38/43 [16:29<01:32, 18.53s/it] 91%|█████████ | 39/43 [16:45<01:11, 17.75s/it] 93%|█████████▎| 40/43 [17:10<01:00, 20.08s/it] 95%|█████████▌| 41/43 [17:36<00:43, 21.67s/it] 98%|█████████▊| 42/43 [17:51<00:19, 19.81s/it]100%|██████████| 43/43 [18:10<00:00, 19.67s/it]100%|██████████| 43/43 [18:10<00:00, 25.37s/it]
07/15/2024 17:39:05 - INFO - __main__ -   Average inference time: 25.321132754170616
